var Pr=Object.defineProperty;var Cr=e=>{throw TypeError(e)};var Ar=(e,t,n)=>t in e?Pr(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var T=(e,t,n)=>Ar(e,typeof t!="symbol"?t+"":t,n);var St=(e,t,n)=>t.has(e)?Cr("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,n);var ve,I,gn,ie,Pt,yn,Ye,ct,Ke,Qe,vn,fe={},bn=[],Dr=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,Le=Array.isArray;function X(e,t){for(var n in t)e[n]=t[n];return e}function xn(e){var t=e.parentNode;t&&t.removeChild(e)}function _e(e,t,n){var i,o,s,a={};for(s in t)s=="key"?i=t[s]:s=="ref"?o=t[s]:a[s]=t[s];if(arguments.length>2&&(a.children=arguments.length>3?ve.call(arguments,2):n),typeof e=="function"&&e.defaultProps!=null)for(s in e.defaultProps)a[s]===void 0&&(a[s]=e.defaultProps[s]);return pe(e,a,i,o,null)}function pe(e,t,n,i,o){var s={type:e,props:t,key:n,ref:i,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,constructor:void 0,__v:o??++gn,__i:-1,__u:0};return o==null&&I.vnode!=null&&I.vnode(s),s}function w(e){return e.children}function Z(e,t){this.props=e,this.context=t}function se(e,t){if(t==null)return e.__?se(e.__,e.__i+1):null;for(var n;t<e.__k.length;t++)if((n=e.__k[t])!=null&&n.__e!=null)return n.__e;return typeof e.type=="function"?se(e):null}function wn(e){var t,n;if((e=e.__)!=null&&e.__c!=null){for(e.__e=e.__c.base=null,t=0;t<e.__k.length;t++)if((n=e.__k[t])!=null&&n.__e!=null){e.__e=e.__c.base=n.__e;break}return wn(e)}}function qe(e){(!e.__d&&(e.__d=!0)&&ie.push(e)&&!Ae.__r++||Pt!==I.debounceRendering)&&((Pt=I.debounceRendering)||yn)(Ae)}function Ae(){var e,t,n,i,o,s,a,c;for(ie.sort(Ye);e=ie.shift();)e.__d&&(t=ie.length,i=void 0,s=(o=(n=e).__v).__e,a=[],c=[],n.__P&&((i=X({},o)).__v=o.__v+1,I.vnode&&I.vnode(i),lt(n.__P,i,o,n.__n,n.__P.namespaceURI,32&o.__u?[s]:null,a,s??se(o),!!(32&o.__u),c),i.__v=o.__v,i.__.__k[i.__i]=i,En(a,i,c),i.__e!=s&&wn(i)),ie.length>t&&ie.sort(Ye));Ae.__r=0}function kn(e,t,n,i,o,s,a,c,l,u,h){var d,f,p,_,k,N=i&&i.__k||bn,x=t.length;for(n.__d=l,Rr(n,t,N),l=n.__d,d=0;d<x;d++)(p=n.__k[d])!=null&&typeof p!="boolean"&&typeof p!="function"&&(f=p.__i===-1?fe:N[p.__i]||fe,p.__i=d,lt(e,p,f,o,s,a,c,l,u,h),_=p.__e,p.ref&&f.ref!=p.ref&&(f.ref&&dt(f.ref,null,p),h.push(p.ref,p.__c||_,p)),k==null&&_!=null&&(k=_),65536&p.__u||f.__k===p.__k?(l&&!l.isConnected&&(l=se(f)),l=Nn(p,l,e)):typeof p.type=="function"&&p.__d!==void 0?l=p.__d:_&&(l=_.nextSibling),p.__d=void 0,p.__u&=-196609);n.__d=l,n.__e=k}function Rr(e,t,n){var i,o,s,a,c,l=t.length,u=n.length,h=u,d=0;for(e.__k=[],i=0;i<l;i++)a=i+d,(o=e.__k[i]=(o=t[i])==null||typeof o=="boolean"||typeof o=="function"?null:typeof o=="string"||typeof o=="number"||typeof o=="bigint"||o.constructor==String?pe(null,o,null,null,null):Le(o)?pe(w,{children:o},null,null,null):o.constructor===void 0&&o.__b>0?pe(o.type,o.props,o.key,o.ref?o.ref:null,o.__v):o)!=null?(o.__=e,o.__b=e.__b+1,c=Lr(o,n,a,h),o.__i=c,s=null,c!==-1&&(h--,(s=n[c])&&(s.__u|=131072)),s==null||s.__v===null?(c==-1&&d--,typeof o.type!="function"&&(o.__u|=65536)):c!==a&&(c===a+1?d++:c>a?h>l-a?d+=c-a:d--:c<a?c==a-1&&(d=c-a):d=0,c!==i+d&&(o.__u|=65536))):(s=n[a])&&s.key==null&&s.__e&&!(131072&s.__u)&&(s.__e==e.__d&&(e.__d=se(s)),Je(s,s,!1),n[a]=null,h--);if(h)for(i=0;i<u;i++)(s=n[i])!=null&&!(131072&s.__u)&&(s.__e==e.__d&&(e.__d=se(s)),Je(s,s))}function Nn(e,t,n){var i,o;if(typeof e.type=="function"){for(i=e.__k,o=0;i&&o<i.length;o++)i[o]&&(i[o].__=e,t=Nn(i[o],t,n));return t}e.__e!=t&&(n.insertBefore(e.__e,t||null),t=e.__e);do t=t&&t.nextSibling;while(t!=null&&t.nodeType===8);return t}function ee(e,t){return t=t||[],e==null||typeof e=="boolean"||(Le(e)?e.some(function(n){ee(n,t)}):t.push(e)),t}function Lr(e,t,n,i){var o=e.key,s=e.type,a=n-1,c=n+1,l=t[n];if(l===null||l&&o==l.key&&s===l.type&&!(131072&l.__u))return n;if(i>(l!=null&&!(131072&l.__u)?1:0))for(;a>=0||c<t.length;){if(a>=0){if((l=t[a])&&!(131072&l.__u)&&o==l.key&&s===l.type)return a;a--}if(c<t.length){if((l=t[c])&&!(131072&l.__u)&&o==l.key&&s===l.type)return c;c++}}return-1}function Ct(e,t,n){t[0]==="-"?e.setProperty(t,n??""):e[t]=n==null?"":typeof n!="number"||Dr.test(t)?n:n+"px"}function xe(e,t,n,i,o){var s;e:if(t==="style")if(typeof n=="string")e.style.cssText=n;else{if(typeof i=="string"&&(e.style.cssText=i=""),i)for(t in i)n&&t in n||Ct(e.style,t,"");if(n)for(t in n)i&&n[t]===i[t]||Ct(e.style,t,n[t])}else if(t[0]==="o"&&t[1]==="n")s=t!==(t=t.replace(/(PointerCapture)$|Capture$/i,"$1")),t=t.toLowerCase()in e||t==="onFocusOut"||t==="onFocusIn"?t.toLowerCase().slice(2):t.slice(2),e.l||(e.l={}),e.l[t+s]=n,n?i?n.u=i.u:(n.u=ct,e.addEventListener(t,s?Qe:Ke,s)):e.removeEventListener(t,s?Qe:Ke,s);else{if(o=="http://www.w3.org/2000/svg")t=t.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if(t!="width"&&t!="height"&&t!="href"&&t!="list"&&t!="form"&&t!="tabIndex"&&t!="download"&&t!="rowSpan"&&t!="colSpan"&&t!="role"&&t in e)try{e[t]=n??"";break e}catch{}typeof n=="function"||(n==null||n===!1&&t[4]!=="-"?e.removeAttribute(t):e.setAttribute(t,n))}}function At(e){return function(t){if(this.l){var n=this.l[t.type+e];if(t.t==null)t.t=ct++;else if(t.t<n.u)return;return n(I.event?I.event(t):t)}}}function lt(e,t,n,i,o,s,a,c,l,u){var h,d,f,p,_,k,N,x,m,b,g,y,v,S,C,P=t.type;if(t.constructor!==void 0)return null;128&n.__u&&(l=!!(32&n.__u),s=[c=t.__e=n.__e]),(h=I.__b)&&h(t);e:if(typeof P=="function")try{if(x=t.props,m=(h=P.contextType)&&i[h.__c],b=h?m?m.props.value:h.__:i,n.__c?N=(d=t.__c=n.__c).__=d.__E:("prototype"in P&&P.prototype.render?t.__c=d=new P(x,b):(t.__c=d=new Z(x,b),d.constructor=P,d.render=Mr),m&&m.sub(d),d.props=x,d.state||(d.state={}),d.context=b,d.__n=i,f=d.__d=!0,d.__h=[],d._sb=[]),d.__s==null&&(d.__s=d.state),P.getDerivedStateFromProps!=null&&(d.__s==d.state&&(d.__s=X({},d.__s)),X(d.__s,P.getDerivedStateFromProps(x,d.__s))),p=d.props,_=d.state,d.__v=t,f)P.getDerivedStateFromProps==null&&d.componentWillMount!=null&&d.componentWillMount(),d.componentDidMount!=null&&d.__h.push(d.componentDidMount);else{if(P.getDerivedStateFromProps==null&&x!==p&&d.componentWillReceiveProps!=null&&d.componentWillReceiveProps(x,b),!d.__e&&(d.shouldComponentUpdate!=null&&d.shouldComponentUpdate(x,d.__s,b)===!1||t.__v===n.__v)){for(t.__v!==n.__v&&(d.props=x,d.state=d.__s,d.__d=!1),t.__e=n.__e,t.__k=n.__k,t.__k.forEach(function(j){j&&(j.__=t)}),g=0;g<d._sb.length;g++)d.__h.push(d._sb[g]);d._sb=[],d.__h.length&&a.push(d);break e}d.componentWillUpdate!=null&&d.componentWillUpdate(x,d.__s,b),d.componentDidUpdate!=null&&d.__h.push(function(){d.componentDidUpdate(p,_,k)})}if(d.context=b,d.props=x,d.__P=e,d.__e=!1,y=I.__r,v=0,"prototype"in P&&P.prototype.render){for(d.state=d.__s,d.__d=!1,y&&y(t),h=d.render(d.props,d.state,d.context),S=0;S<d._sb.length;S++)d.__h.push(d._sb[S]);d._sb=[]}else do d.__d=!1,y&&y(t),h=d.render(d.props,d.state,d.context),d.state=d.__s;while(d.__d&&++v<25);d.state=d.__s,d.getChildContext!=null&&(i=X(X({},i),d.getChildContext())),f||d.getSnapshotBeforeUpdate==null||(k=d.getSnapshotBeforeUpdate(p,_)),kn(e,Le(C=h!=null&&h.type===w&&h.key==null?h.props.children:h)?C:[C],t,n,i,o,s,a,c,l,u),d.base=t.__e,t.__u&=-161,d.__h.length&&a.push(d),N&&(d.__E=d.__=null)}catch(j){t.__v=null,l||s!=null?(t.__e=c,t.__u|=l?160:32,s[s.indexOf(c)]=null):(t.__e=n.__e,t.__k=n.__k),I.__e(j,t,n)}else s==null&&t.__v===n.__v?(t.__k=n.__k,t.__e=n.__e):t.__e=$r(n.__e,t,n,i,o,s,a,l,u);(h=I.diffed)&&h(t)}function En(e,t,n){t.__d=void 0;for(var i=0;i<n.length;i++)dt(n[i],n[++i],n[++i]);I.__c&&I.__c(t,e),e.some(function(o){try{e=o.__h,o.__h=[],e.some(function(s){s.call(o)})}catch(s){I.__e(s,o.__v)}})}function $r(e,t,n,i,o,s,a,c,l){var u,h,d,f,p,_,k,N=n.props,x=t.props,m=t.type;if(m==="svg"?o="http://www.w3.org/2000/svg":m==="math"?o="http://www.w3.org/1998/Math/MathML":o||(o="http://www.w3.org/1999/xhtml"),s!=null){for(u=0;u<s.length;u++)if((p=s[u])&&"setAttribute"in p==!!m&&(m?p.localName===m:p.nodeType===3)){e=p,s[u]=null;break}}if(e==null){if(m===null)return document.createTextNode(x);e=document.createElementNS(o,m,x.is&&x),s=null,c=!1}if(m===null)N===x||c&&e.data===x||(e.data=x);else{if(s=s&&ve.call(e.childNodes),N=n.props||fe,!c&&s!=null)for(N={},u=0;u<e.attributes.length;u++)N[(p=e.attributes[u]).name]=p.value;for(u in N)if(p=N[u],u!="children"){if(u=="dangerouslySetInnerHTML")d=p;else if(u!=="key"&&!(u in x)){if(u=="value"&&"defaultValue"in x||u=="checked"&&"defaultChecked"in x)continue;xe(e,u,null,p,o)}}for(u in x)p=x[u],u=="children"?f=p:u=="dangerouslySetInnerHTML"?h=p:u=="value"?_=p:u=="checked"?k=p:u==="key"||c&&typeof p!="function"||N[u]===p||xe(e,u,p,N[u],o);if(h)c||d&&(h.__html===d.__html||h.__html===e.innerHTML)||(e.innerHTML=h.__html),t.__k=[];else if(d&&(e.innerHTML=""),kn(e,Le(f)?f:[f],t,n,i,m==="foreignObject"?"http://www.w3.org/1999/xhtml":o,s,a,s?s[0]:n.__k&&se(n,0),c,l),s!=null)for(u=s.length;u--;)s[u]!=null&&xn(s[u]);c||(u="value",_!==void 0&&(_!==e[u]||m==="progress"&&!_||m==="option"&&_!==N[u])&&xe(e,u,_,N[u],o),u="checked",k!==void 0&&k!==e[u]&&xe(e,u,k,N[u],o))}return e}function dt(e,t,n){try{typeof e=="function"?e(t):e.current=t}catch(i){I.__e(i,n)}}function Je(e,t,n){var i,o;if(I.unmount&&I.unmount(e),(i=e.ref)&&(i.current&&i.current!==e.__e||dt(i,null,t)),(i=e.__c)!=null){if(i.componentWillUnmount)try{i.componentWillUnmount()}catch(s){I.__e(s,t)}i.base=i.__P=null}if(i=e.__k)for(o=0;o<i.length;o++)i[o]&&Je(i[o],t,n||typeof e.type!="function");n||e.__e==null||xn(e.__e),e.__c=e.__=e.__e=e.__d=void 0}function Mr(e,t,n){return this.constructor(e,n)}function In(e,t,n){var i,o,s,a;I.__&&I.__(e,t),o=(i=typeof n=="function")?null:t.__k,s=[],a=[],lt(t,e=(!i&&n||t).__k=_e(w,null,[e]),o||fe,fe,t.namespaceURI,!i&&n?[n]:o?null:t.firstChild?ve.call(t.childNodes):null,s,!i&&n?n:o?o.__e:t.firstChild,i,a),En(s,e,a)}function Or(e,t,n){var i,o,s,a,c=X({},e.props);for(s in e.type&&e.type.defaultProps&&(a=e.type.defaultProps),t)s=="key"?i=t[s]:s=="ref"?o=t[s]:c[s]=t[s]===void 0&&a!==void 0?a[s]:t[s];return arguments.length>2&&(c.children=arguments.length>3?ve.call(arguments,2):n),pe(e.type,c,i||e.key,o||e.ref,null)}function K(e,t){var n={__c:t="__cC"+vn++,__:e,Consumer:function(i,o){return i.children(o)},Provider:function(i){var o,s;return this.getChildContext||(o=[],(s={})[t]=this,this.getChildContext=function(){return s},this.shouldComponentUpdate=function(a){this.props.value!==a.value&&o.some(function(c){c.__e=!0,qe(c)})},this.sub=function(a){o.push(a);var c=a.componentWillUnmount;a.componentWillUnmount=function(){o.splice(o.indexOf(a),1),c&&c.call(a)}}),i.children}};return n.Provider.__=n.Consumer.contextType=n}ve=bn.slice,I={__e:function(e,t,n,i){for(var o,s,a;t=t.__;)if((o=t.__c)&&!o.__)try{if((s=o.constructor)&&s.getDerivedStateFromError!=null&&(o.setState(s.getDerivedStateFromError(e)),a=o.__d),o.componentDidCatch!=null&&(o.componentDidCatch(e,i||{}),a=o.__d),a)return o.__E=o}catch(c){e=c}throw e}},gn=0,Z.prototype.setState=function(e,t){var n;n=this.__s!=null&&this.__s!==this.state?this.__s:this.__s=X({},this.state),typeof e=="function"&&(e=e(X({},n),this.props)),e&&X(n,e),e!=null&&this.__v&&(t&&this._sb.push(t),qe(this))},Z.prototype.forceUpdate=function(e){this.__v&&(this.__e=!0,e&&this.__h.push(e),qe(this))},Z.prototype.render=w,ie=[],yn=typeof Promise=="function"?Promise.prototype.then.bind(Promise.resolve()):setTimeout,Ye=function(e,t){return e.__v.__b-t.__v.__b},Ae.__r=0,ct=0,Ke=At(!1),Qe=At(!0),vn=0;var oe,D,Ge,Dt,ge=0,Tn=[],Se=[],R=I,Rt=R.__b,Lt=R.__r,$t=R.diffed,Mt=R.__c,Ot=R.unmount,Bt=R.__;function be(e,t){R.__h&&R.__h(D,e,ge||t),ge=0;var n=D.__H||(D.__H={__:[],__h:[]});return e>=n.__.length&&n.__.push({__V:Se}),n.__[e]}function E(e){return ge=1,Br(Sn,e)}function Br(e,t,n){var i=be(oe++,2);if(i.t=e,!i.__c&&(i.__=[n?n(t):Sn(void 0,t),function(c){var l=i.__N?i.__N[0]:i.__[0],u=i.t(l,c);l!==u&&(i.__N=[u,i.__[1]],i.__c.setState({}))}],i.__c=D,!D.u)){var o=function(c,l,u){if(!i.__c.__H)return!0;var h=i.__c.__H.__.filter(function(f){return!!f.__c});if(h.every(function(f){return!f.__N}))return!s||s.call(this,c,l,u);var d=!1;return h.forEach(function(f){if(f.__N){var p=f.__[0];f.__=f.__N,f.__N=void 0,p!==f.__[0]&&(d=!0)}}),!(!d&&i.__c.props===c)&&(!s||s.call(this,c,l,u))};D.u=!0;var s=D.shouldComponentUpdate,a=D.componentWillUpdate;D.componentWillUpdate=function(c,l,u){if(this.__e){var h=s;s=void 0,o(c,l,u),s=h}a&&a.call(this,c,l,u)},D.shouldComponentUpdate=o}return i.__N||i.__}function A(e,t){var n=be(oe++,3);!R.__s&&pt(n.__H,t)&&(n.__=e,n.i=t,D.__H.__h.push(n))}function ut(e,t){var n=be(oe++,4);!R.__s&&pt(n.__H,t)&&(n.__=e,n.i=t,D.__h.push(n))}function te(e){return ge=5,ht(function(){return{current:e}},[])}function ht(e,t){var n=be(oe++,7);return pt(n.__H,t)?(n.__V=e(),n.i=t,n.__h=e,n.__V):n.__}function W(e,t){return ge=8,ht(function(){return e},t)}function Q(e){var t=D.context[e.__c],n=be(oe++,9);return n.c=e,t?(n.__==null&&(n.__=!0,t.sub(D)),t.props.value):e.__}function Gr(){for(var e;e=Tn.shift();)if(e.__P&&e.__H)try{e.__H.__h.forEach(Pe),e.__H.__h.forEach(Xe),e.__H.__h=[]}catch(t){e.__H.__h=[],R.__e(t,e.__v)}}R.__b=function(e){D=null,Rt&&Rt(e)},R.__=function(e,t){e&&t.__k&&t.__k.__m&&(e.__m=t.__k.__m),Bt&&Bt(e,t)},R.__r=function(e){Lt&&Lt(e),oe=0;var t=(D=e.__c).__H;t&&(Ge===D?(t.__h=[],D.__h=[],t.__.forEach(function(n){n.__N&&(n.__=n.__N),n.__V=Se,n.__N=n.i=void 0})):(t.__h.forEach(Pe),t.__h.forEach(Xe),t.__h=[],oe=0)),Ge=D},R.diffed=function(e){$t&&$t(e);var t=e.__c;t&&t.__H&&(t.__H.__h.length&&(Tn.push(t)!==1&&Dt===R.requestAnimationFrame||((Dt=R.requestAnimationFrame)||Ur)(Gr)),t.__H.__.forEach(function(n){n.i&&(n.__H=n.i),n.__V!==Se&&(n.__=n.__V),n.i=void 0,n.__V=Se})),Ge=D=null},R.__c=function(e,t){t.some(function(n){try{n.__h.forEach(Pe),n.__h=n.__h.filter(function(i){return!i.__||Xe(i)})}catch(i){t.some(function(o){o.__h&&(o.__h=[])}),t=[],R.__e(i,n.__v)}}),Mt&&Mt(e,t)},R.unmount=function(e){Ot&&Ot(e);var t,n=e.__c;n&&n.__H&&(n.__H.__.forEach(function(i){try{Pe(i)}catch(o){t=o}}),n.__H=void 0,t&&R.__e(t,n.__v))};var Gt=typeof requestAnimationFrame=="function";function Ur(e){var t,n=function(){clearTimeout(i),Gt&&cancelAnimationFrame(t),setTimeout(e)},i=setTimeout(n,100);Gt&&(t=requestAnimationFrame(n))}function Pe(e){var t=D,n=e.__c;typeof n=="function"&&(e.__c=void 0,n()),D=t}function Xe(e){var t=D;e.__c=e.__(),D=t}function pt(e,t){return!e||e.length!==t.length||t.some(function(n,i){return n!==e[i]})}function Sn(e,t){return typeof t=="function"?t(e):t}function zr(e,t){for(var n in t)e[n]=t[n];return e}function Ze(e,t){for(var n in e)if(n!=="__source"&&!(n in t))return!0;for(var i in t)if(i!=="__source"&&e[i]!==t[i])return!0;return!1}function Ut(e,t){this.props=e,this.context=t}function mt(e,t){function n(o){var s=this.props.ref,a=s==o.ref;return!a&&s&&(s.call?s(null):s.current=null),t?!t(this.props,o)||!a:Ze(this.props,o)}function i(o){return this.shouldComponentUpdate=n,_e(e,o)}return i.displayName="Memo("+(e.displayName||e.name)+")",i.prototype.isReactComponent=!0,i.__f=!0,i}(Ut.prototype=new Z).isPureReactComponent=!0,Ut.prototype.shouldComponentUpdate=function(e,t){return Ze(this.props,e)||Ze(this.state,t)};var zt=I.__b;I.__b=function(e){e.type&&e.type.__f&&e.ref&&(e.props.ref=e.ref,e.ref=null),zt&&zt(e)};var Ht=function(e,t){return e==null?null:ee(ee(e).map(t))},Hr={map:Ht,forEach:Ht,count:function(e){return e?ee(e).length:0},only:function(e){var t=ee(e);if(t.length!==1)throw"Children.only";return t[0]},toArray:ee},Fr=I.__e;I.__e=function(e,t,n,i){if(e.then){for(var o,s=t;s=s.__;)if((o=s.__c)&&o.__c)return t.__e==null&&(t.__e=n.__e,t.__k=n.__k),o.__c(e,t)}Fr(e,t,n,i)};var Ft=I.unmount;function Pn(e,t,n){return e&&(e.__c&&e.__c.__H&&(e.__c.__H.__.forEach(function(i){typeof i.__c=="function"&&i.__c()}),e.__c.__H=null),(e=zr({},e)).__c!=null&&(e.__c.__P===n&&(e.__c.__P=t),e.__c=null),e.__k=e.__k&&e.__k.map(function(i){return Pn(i,t,n)})),e}function Cn(e,t,n){return e&&n&&(e.__v=null,e.__k=e.__k&&e.__k.map(function(i){return Cn(i,t,n)}),e.__c&&e.__c.__P===t&&(e.__e&&n.appendChild(e.__e),e.__c.__e=!0,e.__c.__P=n)),e}function Ue(){this.__u=0,this.t=null,this.__b=null}function An(e){var t=e.__.__c;return t&&t.__a&&t.__a(e)}function we(){this.u=null,this.o=null}I.unmount=function(e){var t=e.__c;t&&t.__R&&t.__R(),t&&32&e.__u&&(e.type=null),Ft&&Ft(e)},(Ue.prototype=new Z).__c=function(e,t){var n=t.__c,i=this;i.t==null&&(i.t=[]),i.t.push(n);var o=An(i.__v),s=!1,a=function(){s||(s=!0,n.__R=null,o?o(c):c())};n.__R=a;var c=function(){if(!--i.__u){if(i.state.__a){var l=i.state.__a;i.__v.__k[0]=Cn(l,l.__c.__P,l.__c.__O)}var u;for(i.setState({__a:i.__b=null});u=i.t.pop();)u.forceUpdate()}};i.__u++||32&t.__u||i.setState({__a:i.__b=i.__v.__k[0]}),e.then(a,a)},Ue.prototype.componentWillUnmount=function(){this.t=[]},Ue.prototype.render=function(e,t){if(this.__b){if(this.__v.__k){var n=document.createElement("div"),i=this.__v.__k[0].__c;this.__v.__k[0]=Pn(this.__b,n,i.__O=i.__P)}this.__b=null}var o=t.__a&&_e(w,null,e.fallback);return o&&(o.__u&=-33),[_e(w,null,t.__a?null:e.children),o]};var jt=function(e,t,n){if(++n[1]===n[0]&&e.o.delete(t),e.props.revealOrder&&(e.props.revealOrder[0]!=="t"||!e.o.size))for(n=e.u;n;){for(;n.length>3;)n.pop()();if(n[1]<n[0])break;e.u=n=n[2]}};(we.prototype=new Z).__a=function(e){var t=this,n=An(t.__v),i=t.o.get(e);return i[0]++,function(o){var s=function(){t.props.revealOrder?(i.push(o),jt(t,e,i)):o()};n?n(s):s()}},we.prototype.render=function(e){this.u=null,this.o=new Map;var t=ee(e.children);e.revealOrder&&e.revealOrder[0]==="b"&&t.reverse();for(var n=t.length;n--;)this.o.set(t[n],this.u=[1,0,this.u]);return e.children},we.prototype.componentDidUpdate=we.prototype.componentDidMount=function(){var e=this;this.o.forEach(function(t,n){jt(e,n,t)})};var Dn=typeof Symbol<"u"&&Symbol.for&&Symbol.for("react.element")||60103,jr=/^(?:accent|alignment|arabic|baseline|cap|clip(?!PathU)|color|dominant|fill|flood|font|glyph(?!R)|horiz|image(!S)|letter|lighting|marker(?!H|W|U)|overline|paint|pointer|shape|stop|strikethrough|stroke|text(?!L)|transform|underline|unicode|units|v|vector|vert|word|writing|x(?!C))[A-Z]/,Wr=/^on(Ani|Tra|Tou|BeforeInp|Compo)/,Vr=/[A-Z0-9]/g,Yr=typeof document<"u",Kr=function(e){return(typeof Symbol<"u"&&typeof Symbol()=="symbol"?/fil|che|rad/:/fil|che|ra/).test(e)};function Qr(e,t,n){return t.__k==null&&(t.textContent=""),In(e,t),typeof n=="function"&&n(),e?e.__c:null}Z.prototype.isReactComponent={},["componentWillMount","componentWillReceiveProps","componentWillUpdate"].forEach(function(e){Object.defineProperty(Z.prototype,e,{configurable:!0,get:function(){return this["UNSAFE_"+e]},set:function(t){Object.defineProperty(this,e,{configurable:!0,writable:!0,value:t})}})});var Wt=I.event;function qr(){}function Jr(){return this.cancelBubble}function Xr(){return this.defaultPrevented}I.event=function(e){return Wt&&(e=Wt(e)),e.persist=qr,e.isPropagationStopped=Jr,e.isDefaultPrevented=Xr,e.nativeEvent=e};var Zr={enumerable:!1,configurable:!0,get:function(){return this.class}},Vt=I.vnode;I.vnode=function(e){typeof e.type=="string"&&function(t){var n=t.props,i=t.type,o={};for(var s in n){var a=n[s];if(!(s==="value"&&"defaultValue"in n&&a==null||Yr&&s==="children"&&i==="noscript"||s==="class"||s==="className")){var c=s.toLowerCase();s==="defaultValue"&&"value"in n&&n.value==null?s="value":s==="download"&&a===!0?a="":c==="translate"&&a==="no"?a=!1:c==="ondoubleclick"?s="ondblclick":c!=="onchange"||i!=="input"&&i!=="textarea"||Kr(n.type)?c==="onfocus"?s="onfocusin":c==="onblur"?s="onfocusout":Wr.test(s)?s=c:i.indexOf("-")===-1&&jr.test(s)?s=s.replace(Vr,"-$&").toLowerCase():a===null&&(a=void 0):c=s="oninput",c==="oninput"&&o[s=c]&&(s="oninputCapture"),o[s]=a}}i=="select"&&o.multiple&&Array.isArray(o.value)&&(o.value=ee(n.children).forEach(function(l){l.props.selected=o.value.indexOf(l.props.value)!=-1})),i=="select"&&o.defaultValue!=null&&(o.value=ee(n.children).forEach(function(l){l.props.selected=o.multiple?o.defaultValue.indexOf(l.props.value)!=-1:o.defaultValue==l.props.value})),n.class&&!n.className?(o.class=n.class,Object.defineProperty(o,"className",Zr)):(n.className&&!n.class||n.class&&n.className)&&(o.class=o.className=n.className),t.props=o}(e),e.$$typeof=Dn,Vt&&Vt(e)};var Yt=I.__r;I.__r=function(e){Yt&&Yt(e),e.__c};var Kt=I.diffed;I.diffed=function(e){Kt&&Kt(e);var t=e.props,n=e.__e;n!=null&&e.type==="textarea"&&"value"in t&&t.value!==n.value&&(n.value=t.value==null?"":t.value)};function Rn(e){return!!e&&e.$$typeof===Dn}function ei(e){return Rn(e)?Or.apply(null,arguments):e}function ti(e){return!!e.__k&&(In(null,e),!0)}var ni=0;function r(e,t,n,i,o,s){t||(t={});var a,c,l=t;if("ref"in l)for(c in l={},t)c=="ref"?a=t[c]:l[c]=t[c];var u={type:e,props:l,key:n,ref:a,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,constructor:void 0,__v:--ni,__i:-1,__u:0,__source:o,__self:s};if(typeof e=="function"&&(a=e.defaultProps))for(c in a)l[c]===void 0&&(l[c]=a[c]);return I.vnode&&I.vnode(u),u}function ri(e){return{render:function(t){Qr(t,e)},unmount:function(){ti(e)}}}let Ln="America/New_York";function ii(e){Ln=e}function M(e){e=new Date(e||Date.now());const t={},n="2-digit";return Intl.DateTimeFormat("en-US",{timeZone:Ln,hourCycle:"h23",year:"numeric",month:n,day:n,hour:n,minute:n,second:n}).formatToParts(e).forEach(i=>t[i.type]=i.value),{date:`${t.year}-${t.month}-${t.day}`,time:`${t.hour}:${t.minute}:${t.second}`}}function Y(e){if(e??(e=M()),(e.time??"1")>"03:00:00")return e.date??M().date;const t=new Date(`${e.date}T00:00:00`);return t.setDate(t.getDate()-1),M(t).date}function si(e,t){const n=new Date(e+"T00:00:00"),i=n.toLocaleString("en-US",{month:"long",day:"numeric"});if(t==="short")return i;const o=Y();if(e===o)return`Today, ${i}`;const s=new Date(o);s.setDate(s.getDate()+1);const a=s.toISOString().split("T")[0];return e===a?`Tomorrow, ${i}`:`${n.toLocaleString("en-US",{weekday:"long"})}, ${i}`}function q(e){const t=e.split(":").slice(0,2).map(Number),n=t[0]>=12?"PM":"AM";return t[0]=t[0]%12||12,t.map(i=>String(i).padStart(2,"0")).join(":").replace(/^0/,"")+" "+n}function et(e){const[t,n]=e.slice(0,19).split("T");return{date:t,time:n}}function De(e){const[t,n]=e.split(":").map(Number);return(t+17)%24*60+n}function me(e){if(!Array.isArray(e))return[];const t=M().time.slice(0,5),n=e.findIndex(i=>i>=t);return n>=0?e.slice(n):[]}const ze=e=>Array.isArray(e)?e.join("."):e,O={get(e){const t=localStorage.getItem(ze(e));try{return JSON.parse(t??"")}catch{return}},set(e,t){localStorage.setItem(ze(e),JSON.stringify(t))},delete(e){localStorage.removeItem(ze(e))},clear(){localStorage.clear()}},He=["bg1","auth"];class $n extends Error{constructor(){super("Auth data missing or expired");T(this,"name","ReauthNeeded")}}class oi{constructor(){T(this,"onUnauthorized",()=>{})}getData(){try{const t=O.get(He);if(t){const{swid:n,accessToken:i,expires:o}=t,s=M(o),a=M();if(s.date>a.date||s.date===a.date&&s.time>a.time&&s.time>="17")return{swid:n,accessToken:i}}}catch(t){console.error(t)}throw this.deleteData(),new $n}setData(t){O.set(He,t)}deleteData(){O.delete(He),setTimeout(this.onUnauthorized)}}const V=new oi,ai=8e3;async function Mn(e,t={}){const{params:n,data:i,timeout:o=ai,...s}=t;t=s,t.referrer||(t.referrer=""),t.credentials||(t.credentials="omit"),t.cache||(t.cache="no-store"),t.headers={...t.headers||{}},n&&Object.keys(n).length>0&&(e+=(e.includes("?")?"&":"?")+Object.entries(n).filter(([,u])=>u!=="").map(u=>u.map(encodeURIComponent).join("=")).join("&")),i&&(t.method||(t.method="POST"),t.headers={...t.headers,"Content-Type":"application/json"},t.body=JSON.stringify(i)),t.method||(t.method="GET");const a=new AbortController;t.signal=a.signal;const c=setTimeout(()=>a.abort(),o);let l;try{l=await fetch(e,t)}catch(u){return console.error(u),{ok:!1,status:0,data:null}}finally{clearTimeout(c)}return{ok:l.ok,status:l.status,data:(l.headers.get("Content-Type")||"").startsWith("application/json")?await l.json():{}}}class On extends Error{constructor(){super(...arguments);T(this,"name","InvalidOrigin")}}class he extends Error{constructor(n,i="Request failed"){super(`${i}: ${JSON.stringify(n)}`);T(this,"name","RequestError");this.response=n}}class $e{constructor(t){T(this,"resort");T(this,"origin");this.resort=t,this.origin=this.constructor.origins[this.resort.id]}static originToResortId(t){var o;const i=(o=Object.entries(this.origins).find(([,s])=>s===t))==null?void 0:o[0];if(i)return i;throw new On(t)}async request(t){const{swid:n,accessToken:i}=V.getData(),o=this.origin+t.path,s=await Mn(o,{method:t.method,params:t.params,data:t.data,headers:{"Accept-Language":"en-US",Authorization:`BEARER ${i}`,"x-user-id":n}});if(s.status===401&&!t.ignoreUnauth)setTimeout(()=>V.deleteData());else{const{key:a}=t;if(s.ok&&(!a||s.data[a]))return{...s,data:a?s.data[a]:s.data}}throw new he(s)}}T($e,"origins",{WDW:"https://disneyworld.disney.go.com",DLR:"https://disneyland.disney.go.com"});const ci="modulepreload",li=function(e){return"/bg1/"+e},Qt={},Re=function(t,n,i){let o=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const s=document.querySelector("meta[property=csp-nonce]"),a=(s==null?void 0:s.nonce)||(s==null?void 0:s.getAttribute("nonce"));o=Promise.all(n.map(c=>{if(c=li(c),c in Qt)return;Qt[c]=!0;const l=c.endsWith(".css"),u=l?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${u}`))return;const h=document.createElement("link");if(h.rel=l?"stylesheet":ci,l||(h.as="script",h.crossOrigin=""),h.href=c,a&&h.setAttribute("nonce",a),document.head.appendChild(h),l)return new Promise((d,f)=>{h.addEventListener("load",d),h.addEventListener("error",()=>f(new Error(`Unable to preload CSS for ${c}`)))})}))}return o.then(()=>t()).catch(s=>{const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=s,window.dispatchEvent(a),!a.defaultPrevented)throw s})},di={48199:"Mr-Incredible",48200:"Mrs-Incredible",261227:"Nemo",339625:"Russell",339626:"Carl",364907:"Jack-Skellington",431014:"Princess-Tiana",431065:"Darth_Vader",15549505:"Rapunzel",15655408:"Default_SignedIn",15675686:"Crush",15831168:"Wall-E",16453979:"Merida",16726412:"Stormtrooper",16818199:"Violet",16869301:"Jack-Jack",17345357:"R2-D2",17345359:"C-3PO",17532220:"Bruce",17532224:"Green-Alien",17532227:"Kermit",17532228:"Sorcerer-Mickey",17577168:"Elsa",17577169:"Anna",17813977:"Olaf",17888784:"Yoda",18101167:"Captain-Mickey",18368743:"-Nick",18368747:"-Judy",18393706:"-Flash",18403761:"kion",18405224:"-Moana",18405236:"-Elena",19633995:"50th_Mickey",19633996:"50th_Minnie",90003819:"Alice",90003846:"Ariel",90003898:"Belle",90003967:"Buzz",90003976:"Captain-Hook",90004004:"Chesire-Cat",90004017:"Cinderella",90004068:"Daisy",90004076:"Dash",90004104:"Donald",90004228:"Goofy",90004260:"Hamm",90004328:"Princess-Jasmine",90004340:"Jiminy",90004395:"Lady",90004482:"Mickey-Mouse",90004486:"Minnie",90004537:"Mulan",90004605:"Peter-Pan",90004625:"Pluto",90004626:"Pocahontas",90004642:"Princess-Aurora",90004682:"Rex",90004772:"Snow-White",90004778:"Sparky",90004846:"TinkerBell",90004860:"Tramp",90004939:"Zero"},ft="https://cdn1.parksmedia.wdprapps.disney.com/resize/mwImage/1/90/90/75/dam/",ui=ft+"wdpro-assets/avatars/180x180/RetAvatar_180x180_",hi=ft+"wdpro-assets/avatars/180x180/RetAvatar-180x180",pi=ft+"disney-world/50th-anniversary/avatars/RetAvatar_180x180_",mi={"-":hi,5:pi};function Ce(e){const t=di[e||""];if(t)return(mi[t[0]]||ui)+t+".png"}const fi=(e,t,n)=>{const i=e[t];return i?typeof i=="function"?i():Promise.resolve(i):new Promise((o,s)=>{(typeof queueMicrotask=="function"?queueMicrotask:setTimeout)(s.bind(null,new Error("Unknown variable dynamic import: "+t+(t.split("/").length!==n?". Note that variables only represent file names one level deep.":""))))})},ce=e=>`/das-vas/api/v1/${e}`;function _i(e){return{id:e.id,name:e.name.replace(/ \(Me\)$/,""),avatarImageUrl:Ce(e.characterId),primary:e.primary}}class tt extends Error{constructor(n){super();T(this,"name","ConflictsError");this.conflicts=n}}class gi extends Error{constructor(){super(...arguments);T(this,"name","NoPrimaryGuest")}}class Bn extends Error{constructor(){super(...arguments);T(this,"name","ExperienceUnavailable")}}var at;class yi extends $e{constructor(){super(...arguments);T(this,"bookingGuestId");St(this,at)}async experiences(n){const i=encodeURIComponent(n.id),{data:o}=await this.request({path:ce(`availability/parks/${i}/experiences`),key:"experiences"});return o.filter(s=>s.available&&!!s.nextAvailableTime).map(s=>{try{return{...s,...this.resort.experience(s.id)}}catch{return s}}).sort((s,a)=>s.name.localeCompare(a.name))}async parties(){const{swid:n}=V.getData(),{data:{bookingGuestId:i,parties:o}}=await this.request({path:ce(`users/${encodeURIComponent(n)}/parties`)});return this.bookingGuestId=i,o.map(s=>[{...s.primaryGuest,primary:!0},...s.linkedGuests].map(_i))}async book({park:n,experience:i,guests:o}){var d,f;const s=await this.eligibility({park:n,experience:i,guests:o}),a=new Set((d=s.find(({type:p})=>p==="ELIGIBLE"))==null?void 0:d.guestIds);if(!o.every(p=>a.has(p.id)))throw new tt(Object.fromEntries(s.filter(p=>p.type!=="ELIGIBLE").flatMap(p=>p.guestIds.map(_=>[_,p.type]))));const c=await this.availability({park:n,experience:i}),l=(f=o.find(p=>p.primary))==null?void 0:f.id,u=new Map(o.map(p=>[p.id,p])),{data:h}=await this.request({path:ce("bookings"),key:"booking",data:{bookingGuestId:this.bookingGuestId,primaryGuestId:l,guestIds:o.map(p=>p.id),experienceId:i.id,startTime:c}});return{type:"DAS",subtype:"IN_PARK",id:i.id,name:i.name,park:n,guests:h.entitlements.map(p=>{const _=u.get(p.guestId);return{id:p.guestId,name:(_==null?void 0:_.name)??"",avatarImageUrl:_==null?void 0:_.avatarImageUrl,entitlementId:p.id}}),start:et(h.startDateTime),end:{},bookingId:h.id}}async cancelBooking(n){const o=n.map(s=>s.entitlementId).map(encodeURIComponent).join(",");await this.request({path:ce(`entitlements/${o}`),method:"DELETE"})}async eligibility({park:n,experience:i,guests:o}={}){const s=o.find(c=>!!c.primary);if(!s)throw new gi;const{data:a}=await this.request({path:ce("eligibility"),params:{experienceId:i.id,parkId:n.id,primaryGuestId:s.id,guestIds:o.map(c=>c.id).join(",")},key:"eligibility"});return a}async availability({park:n,experience:i}){const o=encodeURIComponent(i.id),s=encodeURIComponent(n.id),{data:{available:a,nextAvailableTime:c}}=await this.request({path:ce(`availability/parks/${s}/experiences/${o}`),key:"experience"});if(!a||!c)throw new Bn;return c}}at=new WeakMap;class vi{constructor(t){T(this,"cachedShowtimes",{});this.resort=t}async shows(t){Object.keys(this.cachedShowtimes).length===0&&(this.cachedShowtimes=(await this.request("showtimes")).data);const n=this.cachedShowtimes[t.id]??{},{time:i}=M();return Object.fromEntries(Object.entries(n).flatMap(([o,s])=>{const a=s.filter(d=>d>=i).map(d=>q(d)),c=a[0],l=a.slice(1),u=c!==void 0,h=u?void 0:"NO_MORE_SHOWS";try{return[[o,{type:"ENTERTAINMENT",...this.resort.experience(o),park:t,standby:{available:u,unavailableReason:h,displayNextShowTime:c},displayAdditionalShowTimes:l}]]}catch(d){if(d instanceof re)return[];throw d}}))}async request(t){const n=await Mn(`https://bg1.joelface.com/livedata/${this.resort.id.toLowerCase()}/${t}.json`);if(!n.ok)throw new Error("Fetch failed");return n}}const bi=e=>e.sort((t,n)=>+n.primary-+t.primary||+n.preselected-+t.preselected||t.name.localeCompare(n.name)),xi=e=>`/application/v1/guest/${e}`;class _t extends $e{async getQueues(){var n;const t=await this.post({resource:"getQueues"});if(!Array.isArray((n=t.data)==null?void 0:n.queues))throw new he(t);return t.data.queues.filter(i=>!!i.categoryContentId).map(({queueId:i,tabContentId:o="",...s})=>{const a={...s,id:i};try{a.park=this.resort.park(o.split(";")[0])}catch(c){if(!(c instanceof re))throw c}return a})}async getQueue(t){const n=(await this.getQueues()).find(i=>i.id===t.id);if(n)return n;throw new Error("Queue not Found")}async getLinkedGuests(t){const{data:n}=await this.post({resource:"getLinkedGuests",data:{queueId:t.id,requestType:"REVIEW"}});return bi(n.guests.map(({guestId:i,firstName:o="",lastName:s="",isPrimaryGuest:a,isPreselected:c,avatarImageUrl:l})=>({id:i,name:`${o} ${s}`.trim(),primary:!!a,preselected:!!c,avatarImageUrl:l})))}async joinQueue(t,n){const i=n.map(a=>a.id),o=await this.post({resource:"joinQueue",data:{queueId:t.id,guestIds:i}}),{data:s}=o;if(s.responseStatus==="OK"){const a=s.positions.find(c=>c.queueId===t.id&&c.guestIds.length>0&&i.some(l=>c.guestIds.includes(l)));if(!a)throw new he(o);return{boardingGroup:a.boardingGroup,conflicts:{},closed:!1}}else if(s.responseStatus==="INVALID_GUEST"||s.responseStatus==="CLOSED_QUEUE"){const a=s.responseStatus==="CLOSED_QUEUE",c=new Set,l={};for(const d of s.conflicts)for(const f of d.guestIds){const p=n.find(_=>_.id===f);p&&(l[p.id]=d.conflictType,c.add(f))}const u=n.filter(d=>!c.has(d.id));if(a||u.length===0)return{boardingGroup:null,conflicts:l,closed:a};const h=await this.joinQueue(t,u);return h.conflicts={...l,...h.conflicts},h}else throw new he(o)}async post(t){try{return await this.request({...t,method:"data"in t?"POST":"GET",path:xi(t.resource)})}catch(n){if(n instanceof he){const i=n.response,{ok:o,status:s}=i;if(!o&&s<500&&s!==401)return i}throw n}}}T(_t,"origins",{WDW:"https://vqguest-svc-wdw.wdprapps.disney.com",DLR:"https://vqguest-svc.wdprapps.disney.com"});class re extends Error{constructor(n){super(`Invalid ID: ${n}`);T(this,"name","InvalidId")}}class Gn{constructor(t,n){T(this,"parks");T(this,"genie");T(this,"vq");T(this,"das");T(this,"liveData");T(this,"parksById");T(this,"expsById");T(this,"dropExpsByPark");var i,o,s;this.id=t,this.parks=n.parks,this.parksById=Object.fromEntries(this.parks.map(a=>[a.id,a])),this.expsById=n.experiences,this.dropExpsByPark=new Map(this.parks.map(a=>[a,[]]));for(const[a,c]of Object.entries(this.expsById))c&&(c.id=a,c.park=c.land.park),c!=null&&c.dropTimes&&((i=this.dropExpsByPark.get(c.land.park))==null||i.push(c));for(const a of this.parks)a.dropTimes=[...new Set((o=this.dropExpsByPark.get(a))==null?void 0:o.flatMap(c=>c.dropTimes??[]))].sort(),(s=this.dropExpsByPark.get(a))==null||s.sort((c,l)=>c.name.localeCompare(l.name));this.genie=new zn(this),this.vq=new _t(this),this.das=new yi(this),this.liveData=new vi(this)}experience(t){const n=this.expsById[t];if(n)return n;throw n!==null&&console.warn(`Missing experience: ${t}`),new re(t)}park(t){const n=this.parksById[t];if(n)return n;throw new re(t)}dropExperiences(t){return this.dropExpsByPark.get(t)??[]}}async function wi(e){const t=await fi(Object.assign({"./data/dlr.ts":()=>Re(()=>import("./dlr.js"),[]),"./data/wdw.ts":()=>Re(()=>import("./wdw.js"),[])}),`./data/${e.toLowerCase()}.ts`,3);return new Gn(e,t)}const ki={WDW:"wdw-itinerary-api",DLR:"dlr-itinerary-web-api"},Ni={WDW:{experience:"80010110",park:"80007944"},DLR:{experience:"353295",park:"330339"}},Ei=new Set(["ACTIVITY","DINING"]),ke=e=>e.split(";")[0];function Un(e){const{date:t,time:n}=M();return e.modifiable&&(t===e.end.date&&n<=(e.end.time??"")||t<(e.end.date??""))}class Ii extends Error{constructor(){super(...arguments);T(this,"name","ModifyNotAllowed")}}function qt(e){if(e&&!Un(e))throw new Ii}class zn extends $e{constructor(n,i){super(n);T(this,"maxPartySize",12);T(this,"nextBookTime");T(this,"onUnauthorized",()=>{});T(this,"partyIds",new Set);T(this,"guestCache",new Map);T(this,"tracker");T(this,"primaryGuestId","");T(this,"convertGuest",n=>{const{id:i,firstName:o,lastName:s,characterId:a,...c}=n,l=`${o} ${s}`.trim();if(!this.guestCache.has(i))switch(n.ineligibleReason){case"INVALID_PARK_ADMISSION":case"PARK_RESERVATION_NEEDED":case"GENIE_PLUS_NEEDED":n.primary&&this.cacheGuest(i,l,a);break;default:this.cacheGuest(i,l,a)}const u=Ce(a);return this.partyIds.size>0&&!this.partyIds.has(i)&&(c.ineligibleReason="NOT_IN_PARTY",delete c.eligibleAfter),{...c,id:i,name:l,avatarImageUrl:u}});this.tracker=i??new Ti}setPartyIds(n){this.partyIds=new Set(n)}async experiences(n){var o,s,a,c;await this.primeGuestCache();const{data:i}=await this.request({path:`/tipboard-vas/api/v2/parks/${encodeURIComponent(n.id)}/experiences`,params:{eligibilityGuestIds:[...this.guestCache.keys()].join(",")}});return this.nextBookTime=(c=(((a=(s=(o=i.eligibility)==null?void 0:o.geniePlusEligibility)==null?void 0:s[Y()])==null?void 0:a.flexEligibilityWindows)||[]).sort((l,u)=>l.time.time.localeCompare(u.time.time))[0])==null?void 0:c.time.time,i.availableExperiences.flatMap(l=>{try{return[{...l,...this.resort.experience(l.id),park:n,experienced:this.tracker.experienced(l)}]}catch(u){if(u instanceof re)return[];throw u}})}async guests(n){var c;const i=Ni[this.resort.id],{data:o}=await this.request({path:"/ea-vas/api/v1/guests",params:{productType:"FLEX",experienceId:(n==null?void 0:n.id)??i.experience,parkId:((c=n==null?void 0:n.park)==null?void 0:c.id)??i.park}});this.primaryGuestId=o.primaryGuestId;const s=o.ineligibleGuests.map(this.convertGuest),a=o.guests.map(this.convertGuest).filter(l=>!("ineligibleReason"in l)||s.push(l)&&!1);return s.sort((l,u)=>{const h=+!l.primary-+!u.primary||l.name.localeCompare(u.name);return l.eligibleAfter||u.eligibleAfter?(l.eligibleAfter||"99").localeCompare(u.eligibleAfter||"99")||h:l.ineligibleReason===u.ineligibleReason?h:l.ineligibleReason==="NOT_IN_PARTY"?1:u.ineligibleReason==="NOT_IN_PARTY"||l.ineligibleReason==="EXPERIENCE_LIMIT_REACHED"?-1:u.ineligibleReason==="EXPERIENCE_LIMIT_REACHED"?1:h}),{eligible:a,ineligible:s}}async offer(n,i,o){qt(o);const{data:{offer:{id:s,date:a,startTime:c,endTime:l,status:u,changeStatus:h},eligibleGuests:d,ineligibleGuests:f}}=await this.request({path:o?"/ea-vas/api/v1/products/modifications/flex/offers":"/ea-vas/api/v2/products/flex/offers",method:"POST",data:{guestIds:((o==null?void 0:o.guests)??i).map(p=>p.id),ineligibleGuests:[],primaryGuestId:i.map(p=>p.id).sort((p,_)=>p.localeCompare(_))[0],parkId:n.park.id,experienceId:n.id,selectedTime:n.flex.nextAvailableTime,...o?{date:M().date,modificationType:n.id===o.id?"TIME":"EXPERIENCE"}:{}},userId:!1});return Re(()=>import("./diu.js"),[]),{id:s,start:{date:a,time:c},end:{date:a,time:l},active:u==="ACTIVE",changed:h!=="NONE",guests:{eligible:(d||[]).map(this.convertGuest),ineligible:(f||[]).map(this.convertGuest)},experience:n}}async book(n,i,o){var p;qt(i);const s=(await Re(async()=>{const{default:_}=await import("./diu.js");return{default:_}},[])).default,a=new Set((o??n.guests.eligible).map(_=>_.id)),{data:c}=await this.request({path:i?"/ea-vas/api/v2/products/modifications/flex/bookings":"/ea-vas/api/v2/products/flex/bookings",method:"POST",userId:!1,data:{offerId:n.id,...await s(n.id),...i?{date:M().date,modificationType:i.id===n.experience.id?"TIME":"EXPERIENCE",existingEntitlements:i.guests.filter(_=>a.has(_.id)).map(_=>({entitlementId:_.entitlementId,entitlementBookingId:_.bookingId})),guestIdsToExclude:i.guests.filter(_=>!a.has(_.id)).map(_=>_.id)}:{}},key:"booking"}),{singleExperienceDetails:{experienceId:l,parkId:u},entitlements:h,startDateTime:d,endDateTime:f}=c;return{type:"LL",subtype:"G+",...this.getBookingExperienceData(l,u),bookingId:(p=h[0])==null?void 0:p.id,start:et(d),end:et(f),cancellable:!0,modifiable:!1,guests:h.map(_=>{const k=this.guestCache.get(_.guestId);return{id:_.guestId,name:(k==null?void 0:k.name)||"",avatarImageUrl:Ce(k==null?void 0:k.characterId),entitlementId:_.id}})}}async cancelBooking(n){const o=n.map(s=>s.entitlementId).map(encodeURIComponent).join(",");await this.request({path:`/ea-vas/api/v1/entitlements/${o}`,method:"DELETE",userId:!1})}async bookings(){const{swid:n}=V.getData(),i=M().date,o=Y(),s=ki[this.resort.id],{data:{items:a=[],assets:c={},profiles:l={}}}=await this.request({path:`/plan/${s}/api/v1/itinerary-items/${n}?item-types=FASTPASS&item-types=DINING&item-types=ACTIVITY&item-types=VIRTUAL_QUEUE_POSITION`,params:{destination:this.resort.id,fields:"items,profiles,assets","guest-locators":n+";type=swid","guest-locator-groups":"MY_FAMILY","start-date":i,"show-friends":"false"},userId:!1,ignoreUnauth:!0}),u=m=>{const{name:b,avatarId:g,type:y}=l[m.id];return{id:ke(m.id),name:`${b.firstName} ${b.lastName}`.trim(),avatarImageUrl:Ce(g),...y==="transactional"&&{transactional:!0}}},h=m=>{const b=c[m.asset],y=c[b.facility].location??"",v=this.getPark(y);v.name===""&&y&&(v.name=c[y].name);const S=new Date(m.startDateTime);return{type:"RES",subtype:m.type,id:ke(m.asset),park:v,name:b.name,start:M(S),guests:m.guests.map(u).sort((P,j)=>+(j.id===this.primaryGuestId)-+(P.id===this.primaryGuestId)||+!j.transactional-+!P.transactional||P.name.localeCompare(j.name)),bookingId:m.id}},d=m=>{const b=c[m.facility],g=new Set;return{...this.getBookingExperienceData(m.facility,b.location,b.name),start:(m.displayStartDate??i)<o?{date:o}:{date:m.displayStartDate??i,time:m.displayStartTime},end:{date:m.displayEndDate,time:m.displayEndTime},guests:m.guests.filter(y=>g.has(y.id)||y.redemptionsRemaining===0?!1:(g.add(y.id),!0)).map(y=>({...u(y),entitlementId:y.entitlementId,bookingId:y.bookingId,...y.redemptionsRemaining!==void 0&&{redemptions:Math.min(y.redemptionsRemaining,y.redemptionsAllowed??1)}})),bookingId:m.id}},f=m=>{const b={FLEX:"G+",STANDARD:"ILL",OTHER:"OTHER"},g=m.multipleExperiences?"MEP":b[m.kind];if(!g)return;const y=g==="G+";let v={type:"LL",subtype:g,...d(m),cancellable:m.cancellable&&y,modifiable:m.modifiable&&y,bookingId:m.id};if(v.modifiable=Un(v),m.multipleExperiences){const S=m.assets.find(C=>C.original);S&&(v={...v,...this.getBookingExperienceData(S.content,c[S.content].location)}),v.choices=m.assets.filter(C=>!C.excluded&&!C.original).map(({content:C})=>{const{name:P,location:j}=c[C];return this.getBookingExperienceData(C,j,P)}).sort((C,P)=>C.name.localeCompare(P.name))}return v},p=m=>{const g={DAS:"IN_PARK",FDS:"ADVANCE"}[m.kind],y=g==="IN_PARK";return{type:"DAS",subtype:g,cancellable:m.cancellable&&y,...d(m)}},_=m=>{const b=c[m.asset],g=c[b.facility],y=this.getBookingExperienceData(b.facility,g.location,b.name);return y.park.name===""&&(y.park.name=g.name),{...y,type:"BG",boardingGroup:m.boardingGroup.id,status:m.status,start:M(new Date(m.startDateTime)),guests:m.guests.map(u),bookingId:m.id}},N={PARK_PASS:m=>{const b=this.getPark(c[m.facility].location);if(b)return{type:"APR",id:b.id,name:b.name,park:b,start:{date:m.displayStartDate,time:"06:00:00"},guests:m.guests.map(u),bookingId:m.id}},DAS:p,FDS:p},x=a.map(m=>{try{if(m.type==="FASTPASS")return(N[m.kind]??f)(m);if(m.type==="VIRTUAL_QUEUE_POSITION")return _(m);if(m.type&&Ei.has(m.type))return h(m)}catch(b){console.error(b)}}).filter(m=>!!m);return this.tracker.update(x,this),x}getPark(n){n=ke(n);try{return this.resort.park(n)}catch(i){if(i instanceof re)return{id:n,name:"",icon:"",geo:{n:0,s:0,e:0,w:0},theme:{bg:"bg-blue-500",text:"text-blue-500"},dropTimes:[]};throw i}}getBookingExperienceData(n,i,o="Experience"){n=ke(n);try{const s=this.resort.experience(n);return{id:n,name:s.name,park:s.park}}catch(s){if(s instanceof re)return{id:n,name:o,park:this.getPark(i)};throw s}}async primeGuestCache(){this.primaryGuestId===""&&(this.primaryGuestId=".",await this.guests())}cacheGuest(n,i,o){this.guestCache.set(n,{name:i,characterId:o})}async request(n){if(n.userId??!0){const{swid:i}=V.getData();n={...n},n.params={...n.params,userId:i}}return super.request(n)}}const Jt=["bg1","genie","bookings"];class Ti{constructor(){T(this,"date");T(this,"expIds",new Set);T(this,"experiencedExpIds",new Set);const{date:t=Y(),expIds:n=[],experiencedExpIds:i=[]}=O.get(Jt)??{};this.date=t,this.expIds=new Set(n),this.experiencedExpIds=new Set(i),this.checkDate()}experienced(t){return this.experiencedExpIds.has(t.id)}async update(t,n){this.checkDate();const i=t.filter(s=>s.type==="LL"&&!!s.cancellable);for(const s of i)this.experiencedExpIds[s.modifiable?"delete":"add"](s.id);const o=this.expIds;this.expIds=new Set(i.map(s=>s.id));for(const s of o){if(this.expIds.has(s))continue;const{ineligible:a}=await n.guests({id:s}),c=a.some(l=>l.ineligibleReason==="EXPERIENCE_LIMIT_REACHED");this.experiencedExpIds[c?"add":"delete"](s)}O.set(Jt,{date:this.date,expIds:[...this.expIds],experiencedExpIds:[...this.experiencedExpIds]})}checkDate(){const t=Y();this.date!==t&&(this.date=t,this.expIds=new Set,this.experiencedExpIds=new Set)}}const Hn=K(new Gn("WDW",{experiences:{},parks:[]})),Si=Hn.Provider,$=()=>Q(Hn),Fn=K({goTo:()=>{},goBack:async()=>{}}),Pi=Fn.Provider,B=()=>Q(Fn),jn=K({current:r("div",{})}),Ci=jn.Provider,Wn=()=>Q(jn);let Ai=0;const Xt=()=>++Ai,Ne=()=>Number(location.hash.slice(1))||0;let nt=()=>{};class Di extends Promise{constructor(){super(t=>{nt=()=>{t(),nt=()=>{}}})}}function Vn({children:e}){const[t,n]=E({current:e}),i=te([{elem:e,key:0}]),o=te({goTo(a,c){let l=Ne(),u;c!=null&&c.replace?(u=i.current[l].key??Xt(),n(h=>({...h,current:a}))):(i.current=i.current.slice(0,++l),location.hash=`#${l}`,u=Xt()),i.current[l]={elem:a,key:u}},goBack({screen:a,props:c}={}){if(a){const l=Ne();for(let u=l-1;u>=0;--u)if(i.current[u].elem.type===a){if(history.go(u-l),c){const h={...i.current[u].elem.props,...c};i.current[u].elem=r(a,{...h})}break}}else history.back();return new Di}});A(()=>{function a(){var u,h;nt();const l=Ne();l>=i.current.length?history.back():n({current:((u=i.current[l])==null?void 0:u.elem)??r("div",{}),prev:(h=i.current[l-1])==null?void 0:h.elem})}function c(l){l.preventDefault()}return location.replace("#0"),addEventListener("hashchange",a),addEventListener("beforeunload",c),()=>{removeEventListener("hashchange",a),removeEventListener("beforeunload",c)}},[]);const s=Math.min(Ne(),i.current.length-1);return r(Pi,{value:o.current,children:r(Ci,{value:t,children:i.current.slice(0,s+1).map(({elem:a,key:c},l)=>r("article",{hidden:l!==s,children:a},c))})})}const gt={bg:"bg-blue-500",text:"text-blue-500"},Yn=K(gt),Kn=Yn.Provider,z=()=>Q(Yn),Ri={normal:"py-1",small:"py-1.5 text-xs uppercase tracking-wide",full:"w-full py-3"};function L(e){const{goBack:t}=B(),{type:n,back:i,onClick:o,className:s,...a}=e;let c=`${Ri[n||"normal"]} ${s||""}`;const{bg:l}=z();return c.includes(" bg-")||(c+=` ${l} text-white`),r("button",{onClick:async()=>{o&&await o(),i&&(i===!0?t():t(i))},className:`${c} inline-flex items-center justify-center min-w-[36px] rounded-lg px-2 font-semibold disabled:opacity-50`,...a})}function F(e){return r("div",{className:"mb-20",children:r("div",{className:"fixed bottom-0 left-0 w-full px-5 pb-5 text-center",children:r(L,{...e,className:"max-w-2xl mx-auto shadow-[0px_4px_8px_-1px_#0005]",type:"full"})})})}function H({children:e,className:t,title:n}){return t||(t=""),t.match(/\bw-\S+\s*/)||(t+=" w-4"),t.match(/\bh-\S+\s*/)||(t+=" h-auto"),r("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",viewBox:"0 0 16 16",className:`mx-auto ${t}`,role:"img",children:[n&&r("title",{children:n}),e]})}/**
 * Modified arrow-left2 icon from [IcoMoon]{@link https://icomoon.io/#icons-icomoon}
 * @license CC-BY-4.0
 */function Li(e){return r(H,{...e,children:r("path",{d:"M0.293,7.337L7.333,0.297C7.723,-0.093 8.357,-0.093 8.747,0.297C9.137,0.687 9.137,1.321 8.747,1.711L3.414,7.044L15,7.044C15.552,7.044 16,7.492 16,8.044C16,8.596 15.552,9.044 15,9.044L3.414,9.044L8.747,14.377C9.137,14.767 9.137,15.401 8.747,15.791C8.357,16.181 7.723,16.181 7.333,15.791L0.293,8.751C0.102,8.561 0,8.307 0,8.044C0,7.781 0.102,7.527 0.293,7.337Z"})})}function $i({title:e,subhead:t,children:n}){const{prev:i}=Wn(),{bg:o,text:s}=z();function a(c){return!Rn(c)||typeof c.type=="string"?c:c.type===w?Hr.map(c.props.children,a):ei(c,{className:`bg-white bg-opacity-90 ${s} ${c.props.className||""}`})}return r("div",{className:`px-3 ext-lg text-white ${o}`,children:[r("div",{className:"flex justify-end gap-x-2 gap-y-1 min-h-[36px] py-2",children:[!!i&&r(L,{back:!0,className:"-my-2 -ml-3",title:"Go Back",children:r(Li,{})}),r("h1",{className:"flex-1 self-center py-1 text-xl font-semibold overflow-hidden whitespace-nowrap",children:e}),a(n)]}),t&&r("div",{className:"flex flex-col gap-y-1 pb-1",children:t})]})}function G({title:e,buttons:t,subhead:n,footer:i,theme:o,children:s,contentRef:a}){const c=z();return o??(o=c),r(Kn,{value:o,children:r("div",{className:"fixed inset-0 flex flex-col",children:[r($i,{title:e,subhead:n,children:t}),r("div",{ref:a,className:"relative flex-1 overflow-auto px-3 pb-3",children:s}),i&&r("div",{className:`relative ${o.bg} text-white font-semibold`,children:i})]})})}const Zt=["bg1","disclaimer","accepted"],Mi={bg:"bg-red-600",text:"text-red-600"};function Oi(){const[e,t]=E(!!O.get(Zt));return e?null:r(Bi,{onAccept:()=>{O.set(Zt,1),t(!0)}})}function Bi({onAccept:e}){return r(G,{title:"Warning!",theme:Mi,children:[r("p",{children:'Use at your own risk. BG1 is highly experimental, for demonstration purposes only, and provided "as is" without warranty of any kind. It is in no way endorsed by or associated with the Walt Disney Company and could stop working at any time for any reason. To ensure the intended experience, always use the official Disney app.'}),r(F,{onClick:e,children:"Accept"})]})}function Qn(){return r(G,{title:"BG1 News",children:r("iframe",{src:"https://joelface.github.io/bg1/news.html",className:"absolute inset-0 w-full h-full"})})}const en=["bg1","news","version"];function Gi(e){const[t,n]=E(()=>{const i=Number(O.get(en));return Number.isInteger(i)?i:0});return t<e?r(w,{children:[r(Qn,{}),r(F,{onClick:()=>{O.set(en,e),n(e)},children:"Close"})]}):null}function yt(e){const t=()=>{document.hidden||e()};return document.addEventListener("visibilitychange",t),()=>{document.removeEventListener("visibilitychange",t)}}const Ui="https://cdn.registerdisney.go.com/v4/OneID.js",Fe="oneid-script",zi="oneid-wrapper",Hi="oneid-secure-responder";function Fi({resort:e,onLogin:t}){return A(()=>{let n=0;async function i(){if(!window.OneID){n=self.setTimeout(i,100);return}const o=navigator.userAgent.includes("Android")?"AND":"IOS",s=window.OneID.get({clientId:`TPR-${e.id}-LBSDK.${o}`,responderPage:"https://bg1.joelface.com/responder.html"});s.on("login",({token:a})=>{t({swid:a.swid,accessToken:a.access_token,expires:new Date(a.exp).getTime()})}),s.on("close",()=>{s.launchLogin()}),await s.init(),s.launchLogin()}if(!document.getElementById(Fe)){const o=document.createElement("script");o.id=Fe,o.src=Ui,document.head.appendChild(o)}return i(),()=>{var o;n&&clearTimeout(n);for(const s of[zi,Hi,Fe]){const a=document.getElementById(s);(o=a==null?void 0:a.parentNode)==null||o.removeChild(a)}}},[e,t]),r("div",{className:"fixed top-0 left-0 w-full h-full border-0"})}const qn=K([]),ji=qn.Provider,Jn=()=>Q(qn);function Wi(){const{das:e}=$(),[t,n]=E([]);return A(()=>{e.parties().then(n)},[e]),t}const tn=["bg1","genie","park"],Xn=K({park:{},setPark:()=>{}}),Vi=({value:e,children:t})=>r(Xn.Provider,{value:e,children:t}),Me=()=>Q(Xn);function Yi(){const e=$(),[t,n]=E(()=>{const i=e.parks[0],{id:o=i.id,date:s=""}=O.get(tn)??{};try{return s===Y()?e.park(o):i}catch(a){return a instanceof re||console.error(a),i}});return A(()=>{O.set(tn,{id:t.id,date:Y()})},[t]),{park:t,setPark:n}}/**
 * Refresh icon from [IcoMoon]{@link https://icomoon.io/#icons-icomoon}
 * @license CC-BY-4.0
 */function vt({className:e}){return r(H,{className:e,children:r("path",{d:"M16 6h-6l2.243-2.243c-1.133-1.133-2.64-1.757-4.243-1.757s-3.109 0.624-4.243 1.757c-1.133 1.133-1.757 2.64-1.757 4.243s0.624 3.109 1.757 4.243c1.133 1.133 2.64 1.757 4.243 1.757s3.109-0.624 4.243-1.757c0.095-0.095 0.185-0.192 0.273-0.292l1.505 1.317c-1.466 1.674-3.62 2.732-6.020 2.732-4.418 0-8-3.582-8-8s3.582-8 8-8c2.209 0 4.209 0.896 5.656 2.344l2.343-2.344v6z"})})}function bt(e){const{children:t,color:n="bg-black",className:i="",...o}=e;return r("div",{className:`fixed inset-0 z-10 flex items-center justify-center p-2 ${n} bg-opacity-75 ${i}`,...o,children:t})}function Ki(){const{bg:e}=z();return r(bt,{color:"bg-white",children:r("div",{className:"w-[50px] mx-auto",children:r("div",{"aria-label":"Loading\u2026",className:`rounded-full p-[20%] ${e}`,children:r(vt,{className:"animate-spin w-full text-white"})})})})}const Qi=3e3,qi={alert:"bg-yellow-200",error:"bg-red-200"};function Zn(){const[,e]=E(0),[t,n]=E(""),[i,o]=E("alert"),s=W((c,l)=>{n(c),o(l||"alert"),e(u=>(clearTimeout(u),c?self.setTimeout(()=>{n("")},Qi):u))},[]);return[t?r(Ji,{message:t,type:i}):null,s]}function Ji({message:e,type:t}){return e?r("div",{role:"alert",className:`fixed bottom-20 left-0 w-full p-2 font-semibold text-center ${qi[t]} text-gray-800`,children:e}):null}async function Xi(e){return new Promise(t=>{setTimeout(t,e)})}const Zi=500;function J(){const[e,t]=E(0),[n,i]=Zn(),o=W(async(a,c={})=>{var _;const{messages:l={},minLoadTime:u=Zi}=c,h={error:"Unknown error occurred",request:"Network request failed",...l};i("");let d=[""];function f(...k){d=k}t(k=>k+1);const p=Xi(u);try{await a(f)}catch(k){const N=(_=k==null?void 0:k.response)==null?void 0:_.status;h[k.name]!==void 0?f(h[k.name],"error"):Number.isInteger(N)?f(N in h?h[N]:h.request,"error"):(console.error(k),f(h.error,"error"))}await p,t(k=>k-1),i(...d)},[i]),s=e>0||n?r(w,{children:[e>0&&r(Ki,{}),n]}):null;return{loadData:o,loaderElem:s,flash:i}}function er(e){const[,t]=E(0);return W((n=0)=>{t(i=>Date.now()-i<n?i:(e(),Date.now()))},[e])}const tr=K({plans:[],refreshPlans:()=>{},loaderElem:null}),es=tr.Provider,ue=()=>Q(tr);function ts(){const{genie:e}=$(),{loadData:t,loaderElem:n}=J(),[i,o]=E([]),s=er(W(()=>{t(async()=>{o(await e.bookings())})},[e,t]));return A(s,[s]),{plans:i,refreshPlans:s,loaderElem:n}}const nr=K({current:void 0,begin:()=>{},end:()=>{}}),ns=nr.Provider,ae=()=>Q(nr),rs=()=>{const[e,t]=E({current:void 0,begin:n=>{t({...e,current:n})},end:()=>{t(n=>n.current?{...n,current:void 0}:n)}});return e},rr=K({tabs:[],active:{name:"",icon:r("div",{}),component:()=>null},changeTab:()=>{},scrollPos:{get:()=>0,set:()=>{}}}),ir=()=>Q(rr);function is({name:e,icon:t}){const n=z(),{active:i,changeTab:o}=ir();if(!o)return null;const a=(i==null?void 0:i.name)===e?`bg-white bg-opacity-90 ${n.text}`:`${n.bg} text-white`;return r("button",{className:"px-4 py-2",onClick:()=>o(e),children:[r("div",{className:`min-w-[3rem] rounded-full py-1.5 ${a}`,children:t}),r("div",{className:"mt-0.5 text-sm",children:e})]})}function xt({title:e,buttons:t,subhead:n,children:i,contentRef:o}){const{tabs:s,scrollPos:a,footer:c}=ir();let l=te(null);return o&&(l=o),ut(()=>{const u=l.current;if(!u)return;u.scroll(0,a.get());const h=()=>a.set(u.scrollTop);return u.addEventListener("scroll",h),()=>u.removeEventListener("scroll",h)},[a]),r(G,{title:e,buttons:t,subhead:n,footer:r(w,{children:[r("div",{className:"flex items-center justify-center",children:s.map(u=>_e(is,{...u,key:u.name}))}),c]}),contentRef:l,children:i})}function ss({tabs:e,footer:t},n){return function i({tabName:o}){const{goTo:s}=B(),a=W(u=>{u!==o&&s(r(i,{tabName:u}),{replace:!0})},[o,s]),c=te(Object.fromEntries(e.map(u=>[u.name,0]))),l=e.find(({name:u})=>u===o);return l?r(rr.Provider,{value:{tabs:e,active:l,changeTab:a,scrollPos:{get:()=>c.current[l.name],set:u=>{c.current[l.name]=u}},footer:t},children:r(n,{tab:l})}):null}}const sr=K({experiences:[],refreshExperiences:()=>{},park:{},setPark:()=>null,loaderElem:null}),os=sr.Provider,Oe=()=>Q(sr);function as(){const{genie:e,liveData:t}=$(),{park:n,setPark:i}=Me(),{loadData:o,loaderElem:s}=J(),[a,c]=E([]),l=er(W(()=>{o(async()=>{const u=t.shows(n);let h={...Object.fromEntries((await e.experiences(n)).map(d=>[d.id,d]))};try{h={...await u,...h}}catch(d){console.error(d)}c(Object.values(h))})},[n,e,t,o]));return A(l,[l]),{experiences:a,park:n,refreshExperiences:l,loaderElem:s,setPark:u=>{i(u),c([])}}}/**
 * Calendar icon from [IcoMoon]{@link https://icomoon.io/#icons-icomoon}
 * @license CC-BY-4.0
 */function or({className:e}){return r(H,{className:e,children:r("path",{d:"M5 6h2v2h-2zM8 6h2v2h-2zM11 6h2v2h-2zM2 12h2v2h-2zM5 12h2v2h-2zM8 12h2v2h-2zM5 9h2v2h-2zM8 9h2v2h-2zM11 9h2v2h-2zM2 9h2v2h-2zM13 0v1h-2v-1h-7v1h-2v-1h-2v16h15v-16h-2zM14 15h-13v-11h13v11z"})})}/**
 * Clock icon from [IcoMoon]{@link https://icomoon.io/#icons-icomoon}
 * @license CC-BY-4.0
 */function cs(e){return r(H,{...e,children:r("path",{d:"M10.293 11.707l-3.293-3.293v-4.414h2v3.586l2.707 2.707zM8 0c-4.418 0-8 3.582-8 8s3.582 8 8 8 8-3.582 8-8-3.582-8-8-8zM8 14c-3.314 0-6-2.686-6-6s2.686-6 6-6c3.314 0 6 2.686 6 6s-2.686 6-6 6z"})})}/**
 * Power icon from [IcoMoon]{@link https://icomoon.io/#icons-icomoon}
 * @license CC-BY-4.0
 */function rt(e){return r(H,{...e,children:r("path",{d:"M6 0l-6 8h6l-4 8 14-10h-8l6-6z"})})}/**
 * Checkmark icon from [IcoMoon]{@link https://icomoon.io/#icons-icomoon}
 * @license CC-BY-4.0
 */function nn({className:e}){return r(H,{className:e,children:r("path",{d:"M13.5 2l-7.5 7.5-3.5-3.5-2.5 2.5 6 6 10-10z"})})}/**
 * Arrow-down icon from [IcoMoon]{@link https://icomoon.io/#icons-icomoon}
 * @license CC-BY-4.0
 */function rn(e){return r(H,{...e,children:r("path",{d:"M8 15.5l7.5-7.5h-4.5v-8h-6v8h-4.5z"})})}/**
 * Star icon from [IcoMoon]{@link https://icomoon.io/#icons-icomoon}
 * @license CC-BY-4.0
 */function ls(e){return r(H,{...e,children:r("path",{d:"M16 6.204l-5.528-0.803-2.472-5.009-2.472 5.009-5.528 0.803 4 3.899-0.944 5.505 4.944-2.599 4.944 2.599-0.944-5.505 4-3.899z"})})}function ne({date:e,time:t,type:n,...i}){return r("time",{...i,dateTime:e||t,children:e?si(e,n):t?q(t):""})}function ar({start:e,end:t}){const n=Y(e),i=Y(t);return t?r(w,{children:[e.time?r(ne,{time:e.time}):r("span",{children:"Park Open"})," \u2013"," ",i>n?r(ne,{date:i,type:"short"}):t.time?r(ne,{time:t.time}):r("span",{children:"Park Close"})]}):r(ne,{time:e.time})}const sn=r("span",{"aria-hidden":!0,children:"\u2022"});function cr({booking:e,button:t}){const n=z();return r("div",{className:"flex items-center gap-x-3",children:[r("div",{className:"flex-1 min-w-0",children:[r("div",{className:"flex items-center gap-x-2 text-gray-500 text-sm font-semibold uppercase whitespace-nowrap",children:[e.type==="DAS"&&r(w,{children:[r("span",{children:"DAS"}),sn]}),e.type==="BG"?r(w,{children:[r("span",{children:["BG ",e.boardingGroup]}),e.status==="SUMMONED"&&r(w,{children:[sn,r("span",{className:`${n.text} font-bold`,children:"Board Now"})]})]}):r(ar,{...e})]}),r("div",{className:"text-lg font-semibold leading-snug truncate",children:e.choices?"Multiple Experiences":e.name})]}),t&&r("div",{children:t})]})}function lr(){const e=ae(),t=z();return e.current?r("div",{className:`${t.bg}`,children:r("div",{className:"-mx-3 pb-3 bg-white text-black",children:[r("div",{className:`pb-1 ${t.bg} text-white text-sm font-semibold uppercase text-center`,children:"Modifying Reservation"}),r("div",{className:"mt-2 px-3",children:r(cr,{booking:e.current,button:r(L,{type:"small",back:{screen:de},onClick:e.end,children:"Keep"})})})]})}):null}function U({guests:e,selectable:t,conflicts:n}){return e.length===0?null:r("ul",{className:"mt-2",children:e.map(i=>{var o;return r("li",{className:"px-3 py-1",children:r("label",{className:"flex items-center",children:[t&&r("input",{type:"checkbox",checked:t.isSelected(i),onChange:()=>t.onToggle(i),className:"mr-3"}),r("span",{className:"w-[48px] h-[48px] leading-[48px] mr-3 rounded-full text-3xl font-bold text-center bg-gray-400 text-white",children:i.avatarImageUrl?r("img",{src:i.avatarImageUrl,alt:"",width:"48",height:"48",className:"rounded-full"}):r("span",{"aria-hidden":"true",children:i.name[0]})}),r("span",{className:"leading-tight",children:[i.name,(n==null?void 0:n[i.id])&&r("span",{className:"block text-xs font-semibold text-red-700 uppercase",children:(o=n[i.id])==null?void 0:o.replace(/_/g," ")})]})]})},i.id)})})}const dr=["bg1","genie","partyIds"];function ur(){const e=O.get(dr)??[];return Array.isArray(e)?e:[]}function ds(){const{genie:e}=$();A(()=>e.setPartyIds(ur()),[e])}function us(){const{genie:e}=$(),{loadData:t,loaderElem:n}=J(),[i,o]=E(!0),[s,a]=E(),[c,l]=E(()=>{const p=new Set(ur());return o(p.size===0),p});function u(){const p=[...c];O.set(dr,p),e.setPartyIds(p)}A(()=>{t(async()=>{const p=await e.guests();a([...p.eligible,...p.ineligible].sort((_,k)=>+!_.primary-+!k.primary||_.name.localeCompare(k.name)))})},[e,t]),A(()=>{i&&l(new Set)},[i]);const h=s==null?void 0:s.filter(p=>c.has(p.id)),d=s==null?void 0:s.filter(p=>!c.has(p.id)),f=p=>r("li",{children:r("label",{className:"flex items-center mt-2",children:[r("input",{type:"radio",name:"auto",onChange:()=>o(p.auto),checked:i===p.auto,className:"mr-2"})," ",p.children]})});return r(G,{title:"Party Selection",children:[r("p",{children:"By default, all eligible guests (up to a maximum of 12) are automatically selected when you book a Lightning Lane. If you would like to limit who you book for, you can manually select your party here."}),r("ul",{children:[r(f,{auto:!0,children:"Book for all eligible guests"}),r(f,{auto:!1,children:"Only book for selected guests"})]}),i?null:(s==null?void 0:s.length)===0?r("p",{className:"text-red-700",children:"No guests to select"}):h&&d?r(w,{children:[h.length>0&&r(w,{children:[r("h3",{children:"Your Party"}),r(U,{guests:h,selectable:{isSelected:()=>!0,onToggle:p=>{const _=new Set(c);_.delete(p.id),l(_)}}})]}),d.length>0&&r(w,{children:[r("h3",{children:"Add to Your Party"}),r(U,{guests:d,selectable:{isSelected:()=>!1,onToggle:p=>{const _=new Set(c);_.add(p.id),l(_)}}})]})]}):null,n,r(F,{back:!0,disabled:!i&&c.size===0,onClick:u,children:"Save"})]})}function Be({name:e,onClick:t,...n}){return r(L,{...n,title:`Refresh ${e}`,onClick:t,children:r(vt,{})})}const hr=K({eligible:[],ineligible:[],selected:[],setSelected:()=>null,experience:{name:"",park:{name:"",theme:{bg:"",text:""}}}}),pr=hr.Provider,mr=()=>Q(hr),hs="https://bg1.joelface.com/ping";async function wt(e,t){const{date:n}=M(),i=["bg1","ping",e.id,t];if(O.get(i)===n)return;const{ok:s}=await fetch(hs,{method:"POST",body:new URLSearchParams({resort:e.id,service:t})});s&&O.set(i,n)}function ps(e){return r(H,{...e,children:r("path",{d:"M 5.5253906 0.9296875 L 3.4042969 3.0507812 L 8.3535156 8 L 3.4042969 12.949219 L 5.5253906 15.070312 L 10.474609 10.121094 L 12.595703 8 L 10.474609 5.8789062 L 5.5253906 0.9296875 z"})})}function fr(e){return r("div",{className:`mt-4 border-2 rounded border-green-600 p-1 font-semibold text-center text-green-600 bg-green-100 ${e.className}`,children:e.children})}function ms({bg:e,experiences:t,heading:n}){return r("div",{className:`mt-4 rounded ${e}`,children:[r("h3",{className:"mt-0 p-1 text-white text-center",children:n}),r("ul",{className:"list-disc py-2 pl-8 bg-white bg-opacity-90",children:t.map(i=>r("li",{children:i.name},i.id))})]})}function kt({start:e,end:t}){return r("div",{className:"mt-4 text-lg",children:[t?"Arrive by":"Reservation at",":"," ",r("span",{className:"pl-1 font-semibold",children:r(ar,{start:e,end:t})})]})}function fs({booking:e,onCancel:t,dasGuest:n}){const{genie:i,das:o}=$(),s=e.type==="DAS"?o:i,{refreshPlans:a}=ue(),[c,l]=E(new Set),{loadData:u,loaderElem:h}=J(),{name:d,park:f,guests:p}=e,_=c.size===0,k=c.size===p.length;async function N(){_||(await u(async()=>{await s.cancelBooking([...c]),a()}),t(p.filter(x=>!c.has(x))))}return r(G,{title:"Cancel Guests",theme:f.theme,children:[r("h2",{children:d}),r("div",{children:f.name}),r(kt,{...e}),r("div",{className:"ml-3",children:r("label",{className:"flex items-center py-4",children:[r("input",{type:"checkbox",checked:k,onChange:()=>l(new Set(k?[]:p))}),r("span",{className:"ml-3",children:"Select All"})]})}),!_&&r("div",{className:"mb-4",children:[r("h3",{children:"Cancel These Guests"}),r(U,{guests:p.filter(x=>c.has(x)),selectable:{isSelected:()=>!0,onToggle:x=>{if(n&&x!==n&&c.has(n))l(new Set);else{const m=new Set(c);m.delete(x),l(m)}}}})]}),!k&&r("div",{children:[r("h3",{children:"Select Guests to Cancel"}),r(U,{guests:p.filter(x=>!c.has(x)),selectable:{isSelected:()=>!1,onToggle:x=>{l(new Set(x===n?p:c).add(x))}}})]}),r(F,{back:!0,disabled:_,onClick:N,children:"Cancel "+(k?"Reservation":"Guests")}),h]})}function ye({booking:e,isNew:t}){var y;const{goTo:n,goBack:i}=B(),{setPark:o}=Me(),s=$(),a=Jn(),{name:c,park:l,choices:u,type:h,subtype:d,start:f}=e,p=h==="DAS"&&d==="IN_PARK"?e.guests.find(v=>a.find(S=>S[0].id===v.id)):void 0,_=ae(),[k,N]=E(e.cancellable&&(h!=="DAS"||p)?e.guests:void 0),x=new Map([[l,[]],...s.parks.map(v=>[v,[]])]);for(const v of u||[])(y=x.get(v.park))==null||y.push(v);const m=[...x].filter(([,v])=>v.length>0).map(([v])=>v),b=(u?m.length===1?m[0]:{}:l).theme??gt;return r(G,{title:"Your "+{LL:"Lightning Lane",DAS:"DAS Selection",BG:"Boarding Group",APR:"Park Pass",RES:"Reservation"}[h],theme:b,buttons:e.modifiable&&r(L,{onClick:()=>{_.begin(e),o(e.park),i({screen:de,props:{tabName:"Genie+"}})},children:"Modify"}),children:[r("div",{className:`-mx-3 px-2 py-1 text-center ${b.bg} text-white text-sm font-semibold uppercase`,children:r(ne,{date:Y(f)})}),u?r("h2",{children:"Multiple Experiences"}):r(w,{children:[r("h2",{children:c}),l.name&&r("div",{children:l.name})]}),h==="BG"?r(w,{children:[e.status==="SUMMONED"&&r(fr,{children:"Your boarding group has been called"}),r("h3",{children:["Boarding Group:"," ",r("span",{className:"ml-1 font-semibold",children:e.boardingGroup})]}),r("p",{children:"Check the official Disney app for return time and other virtual queue information."})]}):r(kt,{...e}),u&&r(w,{children:[r("p",{children:[r("b",{children:c})," was temporarily unavailable during your return time. You may redeem this Lightning Lane at one of these replacement experiences:"]}),[...x].filter(([,v])=>v.length>0).map(([v,S])=>r(ms,{heading:v.name,experiences:S,bg:v.theme.bg},v.id))]}),r("div",{className:"flex mt-4",children:[r("h3",{className:"inline mt-0",children:"Your Party"}),e.cancellable&&k&&r(L,{type:"small",onClick:()=>{n(r(fs,{booking:{...e,guests:k},dasGuest:p,onCancel:v=>{v.length>0?N(v):i()}}))},className:"ml-3",children:"Cancel"})]}),r(U,{guests:k||e.guests,conflicts:Object.fromEntries(e.type==="LL"?e.guests.filter(v=>(v.redemptions??1)!==1).map(v=>[v.id,`Redemptions left: ${v.redemptions}`]):[])}),t&&r(F,{onClick:()=>i({screen:de,props:{tabName:"Plans"}}),children:"Show Plans"})]})}function _r({...e}){const{plans:t,refreshPlans:n,loaderElem:i}=ue();return r(xt,{title:"Your Plans",buttons:r(Be,{name:"Plans",onClick:n}),theme:gt,...e,children:[r(_s,{plans:t}),i]})}const _s=mt(function({plans:t}){var l,u;const{goTo:n}=B(),i=z();function o(h){n(r(ye,{booking:h}))}const s=new Map,a=new Map;for(const h of t){const d=Y(h.start);s.has(d)||s.set(d,[]),h.type!=="APR"&&((l=s.get(d))==null||l.push(h)),a.has(d)||a.set(d,new Set),(h.type!=="LL"||h.subtype!=="MEP")&&h.park.icon&&((u=a.get(d))==null||u.add(h.park))}const c=r("p",{className:"font-semibold text-center uppercase text-gray-500",children:"No existing plans"});return r("ul",{children:t.length>0?[...s].map(([h,d])=>r("li",{children:[r("div",{className:"sticky top-0 -mx-3 pt-1 bg-white",children:r("div",{className:"flex items-center",children:[r("h2",{className:`flex-1 mt-0 rounded-r-full px-3 py-1 ${i.bg} text-white text-sm uppercase`,children:r(ne,{date:h})}),r("ul",{className:"px-3 pl-2 text-lg text-right",children:[...a.get(h)??[]].map(f=>r("li",{className:"inline ml-1 first:ml-0","aria-label":f.name,children:f.icon},f.id))})]})}),d.length>0?r("ul",{className:d.length===0?"mt-3":"",children:d.map(f=>r("li",{className:"py-2.5 first:border-0 border-t-4 border-gray-300",onClick:()=>o(f),children:r(cr,{booking:f,button:r("button",{className:i.text,title:"More Info",children:r(ps,{})})})},f.bookingId))}):c]},h)):c})});function gs({...e}){const{goTo:t}=B();return r(w,{children:r(L,{...e,onClick:()=>t(r(_r,{})),title:"Plans",children:r(or,{})})})}function Nt(){const{ineligible:e}=mr();return r(U,{guests:e,conflicts:Object.fromEntries(e.map(t=>[t.id,t.eligibleAfter?`TOO EARLY (${q(t.eligibleAfter)})`:t.ineligibleReason||"ELIGIBLE FOR NEW BOOKING"]))})}function ys(){const{genie:e}=$(),t=ae();return r(w,{children:[t.current?r(w,{children:[r("h3",{children:"Unable to Modify"}),r("p",{children:"Your current reservation cannot be modified to this experience due to the following conflicts:"})]}):r(w,{children:[e.nextBookTime&&e.nextBookTime.slice(0,5)>M().time.slice(0,5)&&r(fr,{children:["Eligible at ",r(ne,{time:e.nextBookTime})]}),r("h3",{children:"No Eligible Guests"}),r("p",{children:"No one in your party is currently eligible for this Lightning Lane."})]}),r(Nt,{})]})}function vs({onRefresh:e}){return r(w,{children:[r("h3",{children:"No Guests Found"}),r("p",{children:"Your party could not be loaded. This is probably just a temporary network error. Wait a few seconds and try again."}),r(F,{onClick:e,children:"Try Again"})]})}function bs(e){return r("div",{className:`mt-4 border-2 rounded border-red-600 p-1 font-semibold text-center text-red-600 bg-red-100 ${e.className}`,children:e.children})}function xs({party:e}){const{eligible:t,ineligible:n,selected:i,setSelected:o,experience:s}=e,[a,c]=E(new Set(i)),[l,u]=Zn(),{maxPartySize:h}=$().genie;function d(f){c(p=>{u(""),p=new Set(p);const _=p.has(f)?"delete":"add";return _==="add"&&p.size>=h?u(`Maximum party size: ${h}`):p[_](f),p})}return r(pr,{value:e,children:r(G,{title:"Modify Party",theme:s.park.theme,children:[r("h2",{children:s.name}),r("div",{children:s.park.name}),r("h3",{children:"Your Party"}),r(U,{guests:t,selectable:{isSelected:f=>a.has(f),onToggle:d}}),n.length>0&&r(w,{children:[r("h3",{children:"Ineligible Guests"}),r(Nt,{})]}),r(F,{back:!0,disabled:a.size===0,onClick:()=>{o(t.filter(f=>a.has(f)))},children:"Confirm Party"}),l]})})}function Et({button:e}){const{goTo:t}=B(),n=mr(),{eligible:i,selected:o}=n,{maxPartySize:s}=$().genie;return r(w,{children:[i.length>s&&o.length===s&&r(bs,{children:"Party size restricted"}),o.length>0?r(w,{children:[r("div",{className:"mt-4",children:[r("h3",{className:"inline mt-0",children:"Your Party"}),r(L,{type:"small",onClick:()=>t(r(xs,{party:n})),className:"ml-3",children:"Modify"})]}),r(U,{guests:o})]}):r(w,{children:[r("h3",{children:"Ineligible Guests"}),r(Nt,{})]}),e]})}function ws(){return r(w,{children:[r("h3",{children:"No Reservations Available"}),r("p",{children:"There aren't enough reservation slots available for your entire party. If only part of your group wishes to go on this attraction, edit your party to check again. Otherwise, go back to the tip board and select another attraction."}),r(Et,{})]})}function ks({offer:e,onBook:t}){const n=ae();return r(w,{children:[r(kt,{...e}),e.changed&&r("div",{className:"text-sm",children:[r("strong",{children:"Note:"})," Return time has been changed"]}),r(Et,{button:r(F,{onClick:t,children:`${n.current?"Modify":"Book"} Lightning Lane`})})]})}const Ns=500,on=100,Es=5,Is=5*6e4;let gr=0,Ee=0;const an=()=>Date.now()+gr;class Ts extends Error{constructor(){super(...arguments);T(this,"name","SyncFailed")}}async function Ss(){if(Date.now()-Ee<Is)return;const e=Ee;Ee=Date.now();let t=on+1;try{const n=[];for(let i=0;i<Es;++i){try{const o=await Ps();Number.isInteger(o)&&n.push(o)}catch(o){console.error(o);continue}if(!(n.length<2)){n.sort((o,s)=>o-s);for(const[o,s]of n.slice(0,-1).entries()){const a=n[o+1],c=Math.abs(s-a);c<t&&(t=c,gr=Math.round((s+a)/2))}if(t<=on)return}}throw new Ts}catch(n){throw Ee=e,n}}async function Ps(){const e=Date.now(),{headers:t}=await fetch("https://bg1.joelface.com/t"),n=Date.now();if(n-e>Ns)return NaN;const o=parseFloat(String(t==null?void 0:t.get("T")))*1e3;return Math.round(o-(e+n)/2)}const Cs=50;function As({onSync:e}){const[t,n]=E(an());return A(()=>{const i=setInterval(()=>n(an()),Cs);return()=>clearInterval(i)},[]),A(()=>{Ss().then(()=>e(!0)).catch(()=>e(!1))},[e]),r("time",{children:M(t).time})}function yr({time:e,label:t}){const[n,i]=E(!0);return r("table",{className:"mt-4 mx-auto text-gray-500",children:r("tbody",{children:[r(cn,{heading:t,time:r("time",{children:e||"--:--:--"})}),r(cn,{heading:"Current time",time:r(w,{children:[r(As,{onSync:i}),!n&&r("span",{className:"text-sm font-sans font-semibold text-red-600",children:[" ","(unsynced)"]})]})})]})})}function cn({heading:e,time:t}){return r("tr",{children:[r("th",{scope:"row",className:"pr-3 text-right text-xs font-semibold uppercase",children:[e,":"]}),r("td",{className:"text-xl font-mono leading-tight",children:["\uFEFF",t]})]})}function Ds({startTime:e,onRefresh:t}){return r(w,{children:[e?r(w,{children:[r(yr,{time:e,label:"Booking start"}),r("p",{children:["At"," ",r("time",{dateTime:e,className:"font-semibold",children:q(e)}),", tap the ",r("span",{className:"font-semibold",children:"Check Availability"})," ","button below to start booking this Lightning Lane."]})]}):r("p",{children:"Sorry, but you can't make a Lightning Lane reservation for this attraction yet."}),r(Et,{button:r(F,{onClick:t,children:"Check Availability"})})]})}function Rs({experience:e}){const{goTo:t}=B(),n=$(),{genie:i}=n,{refreshPlans:o}=ue(),s=ae(),[a,c]=E(),[l,u]=E(!e.flex.available&&e.flex.enrollmentStartTime!==void 0),[h,d]=E(l?null:void 0),{loadData:f,loaderElem:p}=J();async function _(){!h||!a||f(async()=>{let g=null;g=await i.book(h,s.current,a.selected),s.end();const y=new Set(a.selected.map(S=>S.id)),v=g.guests.filter(S=>!y.has(S.id));v.length>0&&(await i.cancelBooking(v),g.guests=g.guests.filter(S=>y.has(S.id))),g&&t(r(ye,{booking:g,isNew:!0}),{replace:!0}),o(),wt(n,"G")},{messages:{410:"Offer expired"}})}function k(){f(async g=>{var S;const v=(await i.experiences(e.park)).find(C=>C.id===e.id);(S=v==null?void 0:v.flex)!=null&&S.available?(u(!1),d(void 0)):g("Reservations not open yet")})}const N=W(()=>{f(async()=>{const g=s.current?{eligible:s.current.guests,ineligible:[]}:await i.guests(e);c({...g,selected:g.eligible.slice(0,i.maxPartySize),setSelected:y=>c(v=>{if(!v)return v;const S=new Set(v.selected);return u(C=>(C||d(P=>P===null||y.some(j=>!S.has(j))?void 0:P),C)),{...v,selected:y}}),experience:e})})},[i,e,s,f]);A(()=>{a||N()},[a,N]);const x=W(g=>{!a||a.selected.length===0||f(async()=>{try{const y=await i.offer(e,a.selected,s.current),{ineligible:v}=y.guests;if(v.length>0){const S=new Set(v.map(P=>P.id)),C=P=>!S.has(P.id);c({...a,eligible:a.eligible.filter(C),ineligible:[...v,...a.ineligible],selected:a.selected.filter(C)})}y.active?(h&&(y.changed=!1),d(y)):d(S=>S??null)}catch(y){throw g||d(null),y}},{messages:{410:h?"No reservations available":""}})},[i,e,a,h,s,f]);A(()=>{h===void 0&&x()},[h,x]);const m=(a==null?void 0:a.eligible.length)===0,b=m&&(a==null?void 0:a.ineligible.length)===0;return r(G,{title:"Lightning Lane",theme:e.park.theme,buttons:r(w,{children:[r(gs,{}),!l&&r(Be,{onClick:()=>{m?N():x()},name:m?"Party":"Offer"})]}),subhead:r(lr,{}),children:[r("h2",{children:e.name}),r("div",{children:e.park.name}),a&&r(pr,{value:a,children:l&&a?r(Ds,{startTime:e.flex.enrollmentStartTime,onRefresh:k}):b?r(vs,{onRefresh:N}):m?r(ys,{}):!a||h===void 0?r("div",{}):h===null?r(ws,{}):r(ks,{offer:h,onBook:_})}),p]})}function It({label:e,children:t}){return r("div",{className:"flex items-center flex-1 whitespace-nowrap",children:[r("span",{className:"mr-2 text-xs font-semibold uppercase text-gray-500",children:e})," ",t]})}function Ls({experience:e}){const{goTo:t}=B(),{flex:n}=e;return r(It,{label:"Genie+",children:r("span",{children:r(L,{onClick:()=>t(r(Rs,{experience:e})),children:n.nextAvailableTime?q(n.nextAvailableTime):"none"})})})}function vr({children:e}){return r("div",{className:"mt-8 flex justify-center",children:r("div",{children:[r("h2",{className:"mt-0 pl-1 text-gray-500 text-sm leading-tight uppercase",children:"Symbols"}),r("div",{className:"border-2 border-gray-500 rounded px-2 py-0.5 bg-gray-100",children:r("table",{children:r("tbody",{children:e})})})]})})}function le({sym:e,def:t,onInfo:n}){return r("tr",{children:[r("th",{className:"py-0.5 text-center font-bold",children:e}),r("td",{className:"pl-3 py-0.5",children:t}),n&&r("td",{className:"pl-3 py-0.5",children:r(L,{type:"small",onClick:n,children:"Info"})})]})}const $s="_SELECT_RADIO_BUTTON_";function br(e){const{options:t,selected:n,title:i,onChange:o,disabled:s,...a}=e,{bg:c}=z(),[l,u]=E(!1),[h,d]=E(0),f=te(null),p=te(null);ut(()=>{var C;if((C=t.values().next().value)!=null&&C.icon)return;const g=f.current,y=g==null?void 0:g.firstChild;if(!y)return;const v=y.nodeValue;if(!v)return;let S=0;for(const P of t.values())y.nodeValue=P.text,S=Math.max(g.offsetWidth,S);y.nodeValue=v,d(S)},[t]);const _=()=>{var g;return(g=p.current)==null?void 0:g.querySelector("input:checked")};A(()=>{var v;if(!l)return;const g=_();(v=g==null?void 0:g.closest("li"))==null||v.scrollIntoView(),g==null||g.focus();const y=S=>{var C;(C=p.current)!=null&&C.contains(S.target)||u(!1)};return addEventListener("focusin",y),()=>removeEventListener("focusin",y)},[l]);const k=()=>{const g=_();if(g){const y=g.value,v=t.get(y);v&&o(v.value??y)}u(!1)},N=n?t.get(n):i!==void 0?{text:i}:void 0;if(!N)return null;const{icon:x,text:m}=N;let b=!1;return r(w,{children:[r(L,{...a,title:x?`${i}: ${m}`:i,disabled:s||t.size===0,onClick:()=>u(!0),children:[x||r("span",{className:"flex-1 truncate",style:{minWidth:`${h}px`},ref:f,children:m}),r(H,{className:"w-2.5 ml-2 shrink-0",children:r("path",{d:"m6.8273 12.401-5.6333-7.7812a1.0212 1.0212 117.05 0 1 0.82716-1.62l11.958-2e-7a1.0212 1.0212 62.952 0 1 0.82714 1.62l-1.6438 2.2705a79984 79984 125.9 0 0-2.3456 3.2401l-1.6437 2.2706a1.4479 1.4479 180 0 1-2.3456 4.4e-5z"})})]}),l&&r(bt,{onChange:()=>{b||k(),b=!1},onClick:g=>{var y;b||(!((y=p.current)!=null&&y.contains(g.target))||n&&g.target.value===n)&&(u(!1),g.preventDefault())},onKeyDown:({key:g})=>{["Enter"," "].includes(g)?k():g.startsWith("Arrow")&&(b=!0)},"data-testid":"shade",children:r("div",{className:"flex flex-col min-w-[50%] max-h-[90%] rounded-lg bg-white text-black",children:[i&&r("h3",{className:`mt-0 rounded-t-lg px-2 py-1 ${c} text-white font-semibold text-center`,children:i}),r("ul",{className:"overflow-auto",ref:p,children:[...t].map(([g,y])=>r("li",{className:"border-t-2 first:border-0 border-gray-300",children:r("label",{className:"flex flex-row items-center gap-x-2.5 px-4 py-3",children:[r("input",{type:"radio",name:$s,value:g,defaultChecked:g===n,className:"w-4 h-4 shrink-0"})," ",y.icon&&r("span",{"aria-hidden":"true",children:y.icon})," ",y.text]})},y.text))})]})})]})}function xr(e){const{parks:t}=$(),{park:n,setPark:i}=Oe(),o=ae(),s=ht(()=>new Map(t.map(a=>[a.id,{value:a,icon:a.icon,text:a.name}])),[t]);return r(br,{...e,options:s,selected:n.id,onChange:i,disabled:!!o.current,title:"Park","data-testid":"park-select"})}function Ms({experience:{type:e,standby:t}}){return t.displayNextShowTime||e==="ENTERTAINMENT"&&!t.waitTime?r(Bs,{standby:t}):r(Os,{standby:t})}const Os=({standby:e})=>r(It,{label:"Standby",children:e.available?r(kr,{time:e.waitTime!==void 0?e.waitTime+" min":"now"}):r(Nr,{text:"down"})}),Bs=({standby:e})=>r(It,{label:r(w,{children:["Next ",r("span",{className:"hidden xs:inline",children:"Show"})]}),children:e.displayNextShowTime?r(kr,{time:e.displayNextShowTime}):r(Nr,{text:"none"})}),wr="inline-block border-2 rounded px-1.5 py-0.5 font-semibold",kr=({time:e})=>r("span",{className:`${wr} border-gray-500 text-gray-500 bg-gray-100`,children:e}),Nr=({text:e})=>r("span",{className:`${wr} border-red-600 text-red-600 bg-red-100`,children:e});function Gs({bookTime:e,dropTime:t}){const n=z();return!e&&!t?null:r("div",{className:`flex justify-center gap-x-10 ${n.bg} text-white text-sm font-semibold uppercase text-center`,children:[r(ln,{label:"Book",time:e}),r(ln,{label:"Drop",time:t})]})}function ln({label:e,time:t}){if(!t)return null;t=t.slice(0,5);const n=M().time.slice(0,5);return r("div",{children:[e,":"," ",r("time",{dateTime:t,className:"whitespace-nowrap",children:t>n?q(t):"now"})]})}async function Us(e={}){return new Promise((t,n)=>{navigator.geolocation.getCurrentPosition(i=>{t(i)},i=>{n(i)},e)})}const zs={maximumAge:15e3,timeout:2e3};function Hs(){const[e,t]=E(),n=W(async()=>{try{const{coords:i}=await Us(zs);t(o=>o&&i.latitude===o[0]&&i.longitude===o[1]?o:[i.latitude,i.longitude])}catch{t(void 0)}},[]);return[e,n]}const Fs=(e,t)=>(e.priority||1/0)-(t.priority||1/0),je=(e,t)=>(t.standby.waitTime||-1)-(e.standby.waitTime||-1),We=(e,t)=>{var n,i;return De(((n=e==null?void 0:e.flex)==null?void 0:n.nextAvailableTime)||"00:00")-De(((i=t==null?void 0:t.flex)==null?void 0:i.nextAvailableTime)||"00:00")},js=(e,t)=>e.name.toLowerCase().localeCompare(t.name.toLowerCase()),dn=(e,t)=>Math.sqrt(Math.pow(e[0]-t[0],2)+Math.pow(e[1]-t[1],2)),Ws=(e,t,n)=>e.geo===t.geo?0:e.geo?t.geo?n?dn(e.geo,n)-dn(t.geo,n):0:-1:1,Vs={priority:(e,t)=>Fs(e,t)||je(e,t)||We(e,t),standby:(e,t)=>je(e,t)||We(e,t),soonest:(e,t)=>We(e,t)||je(e,t),nearby:(e,t,n)=>Ws(e,t,n),aToZ:()=>0},Ys=new Map([["priority",{text:"Priority"}],["nearby",{text:"Nearby"}],["standby",{text:"Standby"}],["soonest",{text:"Soonest"}],["aToZ",{text:"A to Z"}]]);function Ks(e,t){const{n,s:i,e:o,w:s}=e.geo,[a,c]=t;return a<n&&a>i&&c<o&&c>s}function Qs(){const{experiences:e,park:t}=Oe(),[n,i]=Hs(),[o,s]=E("priority");A(()=>{o==="nearby"&&i()},[e,o,i]);const a=W((l,u)=>{var h,d;return Number((h=u==null?void 0:u.flex)==null?void 0:h.available)-Number((d=l==null?void 0:l.flex)==null?void 0:d.available)||Vs[o==="nearby"&&!(n&&Ks(t,n))?"priority":o](l,u,n)||js(l,u)},[n,t,o]),c=W(l=>r(br,{...l,options:Ys,selected:o,onChange:s,title:"Sort By"}),[o]);return{sorter:a,SortSelect:c}}const qs=30,Js=60,un=["bg1","genie","tipBoard","starred"],it="Lightning Pick",st="Upcoming Drop",ot="Booked",hn=e=>e.experienced&&!e.starred;function Xs({contentRef:e}){ds();const{genie:t}=$(),{experiences:n,refreshExperiences:i,park:o,loaderElem:s}=Oe(),{sorter:a,SortSelect:c}=Qs(),l=te(!0);A(()=>{var h;l.current||(h=e.current)==null||h.scroll(0,0)},[c,e]),A(()=>{l.current=!1},[]);const u=me(o.dropTimes)[0];return r(xt,{title:"Genie+",buttons:r(w,{children:[r(c,{}),r(xr,{}),r(Be,{name:"Experiences",onClick:i})]}),subhead:r(w,{children:[r(lr,{}),r(Gs,{bookTime:t.nextBookTime,dropTime:u})]}),contentRef:e,children:[r(Zs,{experiences:n,park:o,dropTime:u,sorter:a}),s]})}const Zs=mt(function({experiences:t,park:n,dropTime:i,sorter:o}){const{goTo:s}=B(),a=z(),[c,l]=E(()=>{const m=O.get(un)??[];return new Set(Array.isArray(m)?m:[])}),u=De(M().time);function h({id:m}){l(b=>(b=new Set(b),b.has(m)?b.delete(m):b.add(m),O.set(un,[...b]),b))}const d=()=>s(r(to,{})),f=m=>s(r(no,{park:n,experience:m})),p=()=>s(r(ro,{})),_=({experiences:m,type:b})=>r("ul",{"data-testid":b,children:m.map(g=>{const[y]=me(g.dropTimes??[]);return r("li",{className:"pb-3 first:border-0 border-t-4 border-gray-300",children:[r("div",{className:"flex items-center gap-x-2 mt-2",children:[r(eo,{experience:g,toggleStar:h}),r("h3",{className:"flex-1 mt-0 text-lg font-semibold leading-tight truncate",children:g.name}),g.lp?r(Ve,{name:it,icon:rt,onClick:d}):y?r(Ve,{name:st,icon:rn,onClick:()=>f(g),className:y!==i?"opacity-50":""}):null,g.flex.preexistingPlan&&r(Ve,{name:ot,icon:nn,onClick:p})]}),r("div",{className:"flex flex-wrap gap-1.5 mt-2",children:[r(Ms,{experience:g}),r(Ls,{experience:g})]})]},g.id+(g.starred?"*":""))})}),k=t.filter(m=>!!m.flex).map(m=>{var y;const b=m.standby.waitTime||0,g=(y=m==null?void 0:m.flex)==null?void 0:y.nextAvailableTime;return{...m,lp:!!g&&b>=qs&&De(g)-u<=Math.min(Js,(4-Math.trunc(m.priority||4))/3*b),starred:c.has(m.id)}}).sort((m,b)=>+!m.starred-+!b.starred||+!m.lp-+!b.lp||o(m,b)),N=k.filter(m=>!hn(m)),x=k.filter(hn).sort((m,b)=>m.name.localeCompare(b.name));return r(w,{children:[r(_,{experiences:N,type:"unexperienced"}),x.length>0&&r(w,{children:[r("h2",{className:`-mx-3 px-3 py-1 text-sm uppercase text-center ${a.bg} text-white`,children:"Previously Experienced"}),r(_,{experiences:x,type:"experienced"})]}),(N.length>0||x.length>0)&&r(vr,{children:[r(le,{sym:r(rt,{className:a.text}),def:it,onInfo:d}),n.dropTimes.length>0&&r(le,{sym:r(rn,{className:a.text}),def:st,onInfo:f}),r(le,{sym:r(nn,{className:a.text}),def:ot,onInfo:p})]})]})});function Ve({name:e,icon:t,onClick:n,className:i}){const o=z();return r("button",{title:`${e} (more info)`,className:`-mx-2 px-2 ${o.text} ${i}`,onClick:n,children:r(t,{})})}function eo({experience:e,toggleStar:t}){const n=z();return r("button",{title:`${e.starred?"Remove from":"Add to"} Favorites`,className:"-m-2 p-2",onClick:()=>t(e),children:r(ls,{className:e.starred?n.text:"text-gray-300"})})}function to(){return r(G,{title:it,children:r("p",{children:"When an attraction with a long standby wait has a Lightning Lane return time in the near future, it's highlighted as a Lightning Pick. Book these quick before they're gone!"})})}function no({park:e,experience:t}){const n=$(),i=me((t==null?void 0:t.dropTimes)??[])[0],o=n.parks.filter(s=>s.dropTimes.length>0).sort((s,a)=>s===e?-1:a===e?1:0);return r(G,{title:st,children:[r("p",{children:[t?r("b",{children:t.name}):"This attraction"," may be part of"," ",i?r(w,{children:["the"," ",r("time",{dateTime:i,className:"font-semibold",children:q(i)})]}):r(w,{children:"an upcoming"})," ","drop of additional Lightning Lane inventory, with earlier return times than what's currently being offered. Availability varies but is always limited, so be sure you're ready to book when the drop time arrives!"]}),o.map(s=>{const[a]=me(s.dropTimes);return r("div",{className:`mt-5 rounded overflow-hidden ${s.theme.bg}`,children:[r("h2",{className:`mt-0 py-1 ${s.theme.bg} text-white text-base text-center`,children:s.name}),r("div",{className:"flex flex-col px-2 pb-3 bg-white bg-opacity-90",children:n.dropExperiences(s).map((c,l)=>{var d;const u=l===1&&s.name==="Hollywood Studios",h=new Set(me(c.dropTimes??[]));return r("div",{children:[r("h3",{className:`mt-3 text-base ${u?`${s.theme.text}font-bold`:""}`,children:c.name}),r("ul",{className:"flex flex-wrap gap-y-2 mt-1 leading-tight",children:(d=c.dropTimes)==null?void 0:d.map(f=>{const p=f===a;return r("li",{className:"min-w-[6em] text-center",children:[r("div",{className:`${p?`${s.theme.text} font-bold`:h.has(f)?"font-semibold":"text-gray-500"}`,children:r("time",{dateTime:f,children:q(f)})}),p?r("div",{className:`rounded-sm ${s.theme.bg} text-white text-opacity-90 text-xs font-semibold text-center uppercase`,children:"next"}):null]},f)})})]},c.id)})})]},s.id)})]})}function ro(){return r(G,{title:ot,children:r("p",{children:"You currently have a Lightning Lane reservation for this attraction."})})}/**
 * Exit icon from [IcoMoon]{@link https://icomoon.io/#icons-icomoon}
 * @license CC-BY-4.0
 */function io(e){return r(H,{...e,children:r("path",{d:"M12 10v-2h-5v-2h5v-2l3 3zM11 9v4h-5v3l-6-3v-13h11v5h-1v-4h-8l4 2v9h4v-3z"})})}/**
 * News icon from [IcoMoon]{@link https://icomoon.io/#icons-icomoon}
 * @license CC-BY-4.0
 */function so(e){return r(H,{...e,children:r("path",{d:"M14 4v-2h-14v11c0 0.552 0.448 1 1 1h13.5c0.828 0 1.5-0.672 1.5-1.5v-8.5h-2zM13 13h-12v-10h12v10zM2 5h10v1h-10zM8 7h4v1h-4zM8 9h4v1h-4zM8 11h3v1h-3zM2 7h5v5h-5z"})})}/**
 * Cog icon from [IcoMoon]{@link https://icomoon.io/#icons-icomoon}
 * @license CC-BY-4.0
 */function oo(e){return r(H,{...e,children:r("path",{d:"M14.59 9.535c-0.839-1.454-0.335-3.317 1.127-4.164l-1.572-2.723c-0.449 0.263-0.972 0.414-1.529 0.414-1.68 0-3.042-1.371-3.042-3.062h-3.145c0.004 0.522-0.126 1.051-0.406 1.535-0.839 1.454-2.706 1.948-4.17 1.106l-1.572 2.723c0.453 0.257 0.845 0.634 1.123 1.117 0.838 1.452 0.336 3.311-1.12 4.16l1.572 2.723c0.448-0.261 0.967-0.41 1.522-0.41 1.675 0 3.033 1.362 3.042 3.046h3.145c-0.001-0.517 0.129-1.040 0.406-1.519 0.838-1.452 2.7-1.947 4.163-1.11l1.572-2.723c-0.45-0.257-0.839-0.633-1.116-1.113zM8 11.24c-1.789 0-3.24-1.45-3.24-3.24s1.45-3.24 3.24-3.24c1.789 0 3.24 1.45 3.24 3.24s-1.45 3.24-3.24 3.24z"})})}/**
 * User icon from [IcoMoon]{@link https://icomoon.io/#icons-icomoon}
 * @license CC-BY-4.0
 */function ao(e){return r(H,{...e,children:r("path",{d:"M9 11.041v-0.825c1.102-0.621 2-2.168 2-3.716 0-2.485 0-4.5-3-4.5s-3 2.015-3 4.5c0 1.548 0.898 3.095 2 3.716v0.825c-3.392 0.277-6 1.944-6 3.959h14c0-2.015-2.608-3.682-6-3.959z"})})}function co(){const{goTo:e}=B(),[t]=E([{text:"Party Selection",icon:r(ao,{}),action:()=>e(r(us,{}))},{text:"Log Out",icon:r(io,{}),action:()=>V.deleteData()},{text:"BG1 News",icon:r(so,{}),action:()=>e(r(Qn,{}))}]),[n,i]=E(!1),o=te(null);return r(w,{children:[r("button",{className:"absolute top-0 right-0 h-full px-4",onClick:()=>i(!0),title:"Settings Menu",children:r(oo,{})}),n&&r(bt,{onClick:s=>{var a;(a=o.current)!=null&&a.contains(s.target)||i(!1)},"data-testid":"shade",children:r("ul",{className:"overflow-auto min-w-[50%] max-h-[90%] rounded-lg bg-white text-black text-lg font-normal",ref:o,children:t.map(s=>r("li",{className:"border-t-2 first:border-0 border-gray-300",children:r("button",{className:"flex flex-row items-center w-full px-4 py-3",onClick:()=>{i(!1),setTimeout(s.action,50)},children:[r("span",{className:"mr-2.5 text-gray-700","aria-hidden":!0,children:s.icon}),s.text]})},s.text))})})]})}function Er(e){const[t,n]=e.split(":").map(Number);return t*60+n}const lo=(e,t)=>Er(e)-t;function pn({park:e,onSelect:t}){const{das:n}=$(),{loadData:i,loaderElem:o}=J(),[s,a]=E();A(()=>{i(async()=>{const l=await n.experiences(e);a(l.filter(u=>u.available&&!!u.nextAvailableTime).sort((u,h)=>u.name.localeCompare(h.name)))})},[e,n,i]);const c=[{heading:"Attractions",type:"ATTRACTION"},{heading:"Characters",type:"CHARACTER"},{heading:"Entertainment",type:"ENTERTAINMENT"}];return r(G,{title:"Select Experience",theme:e.theme,children:[s?s.length===0?r("p",{children:"No DAS experiences available"}):r(w,{children:c.map(l=>r(uo,{park:e,experiences:s.filter(u=>u.type===l.type),heading:l.heading,onSelect:t},l.type))}):null,o]})}function uo({park:e,experiences:t,heading:n,onSelect:i}){if(t.length===0)return null;const o=Er(M().time);return r("div",{className:`mt-4 rounded overflow-hidden ${e.theme.bg}`,children:[r("h3",{className:"mt-0 py-1 text-white text-xs font-semibold text-center uppercase",children:n}),r("ul",{className:"bg-white bg-opacity-90 leading-snug",children:t.map(s=>r("li",{className:"flex items-center pt-3 last:pb-3",children:[r("div",{className:"flex-1 px-2",children:s.name}),r("div",{className:"px-2",children:r(L,{onClick:()=>i(s),children:r("span",{className:"min-w-[4rem]",children:[lo(s.nextAvailableTime,o)," ",r("abbr",{title:"minutes",children:"min."})]})})})]},s.id))})]})}function mn({park:e,party:t}){const{goTo:n,goBack:i}=B(),o=$(),{das:s}=o,{refreshPlans:a}=ue(),[c,l]=E(),[u,h]=E(new Set(t)),[d,f]=E({}),{loadData:p,loaderElem:_}=J();async function k(){c&&p(async()=>{try{const N=await s.book({park:e,experience:c,guests:[...u]});a(),wt(o,"D"),await i({screen:de}),n(r(ye,{booking:N,isNew:!0}))}catch(N){throw N instanceof tt&&f(N.conflicts),N}},{messages:{[tt.name]:"Some guests not eligible",[Bn.name]:"Experience currently unavailable"}})}return r(G,{title:"DAS Selection",theme:e.theme,children:[r("h3",{children:"Experience"}),c?r("div",{className:"flex items-center mt-3",children:[r("div",{className:"text-lg font-semibold truncate",children:c.name}),r("div",{className:"ml-3",children:r(L,{type:"small",onClick:()=>n(r(pn,{park:e,onSelect:N=>{l(N),i()}})),children:"Modify"})})]}):r("div",{className:"mt-3 text-center",children:r(L,{onClick:()=>n(r(pn,{park:e,onSelect:N=>{l(N),i()}})),children:"Select Experience"})}),r("h3",{children:"DAS Guest"}),r(U,{guests:t.slice(0,1),conflicts:d}),t.length>1&&r(w,{children:[r("h3",{children:"Additional Guests"}),r(U,{guests:t.slice(1),selectable:{isSelected:N=>u.has(N),onToggle:N=>{u.has(N)?u.delete(N):u.add(N),h(new Set(u))}},conflicts:d})]}),r(F,{disabled:!t||!c,onClick:k,children:"Request Return Time"}),_]})}function ho({parties:e}){const{goTo:t}=B(),{park:n}=Me(),{plans:i,refreshPlans:o,loaderElem:s}=ue();ut(o,[o]);const a=new Set(e.map(d=>d[0]).map(d=>d.id)),c=i.filter(d=>d.type==="DAS"&&d.subtype==="IN_PARK"),l=new Map(c.filter(d=>d.type==="DAS"&&d.subtype==="IN_PARK").map(d=>{var f;return[((f=d.guests.find(p=>a.has(p.id)))==null?void 0:f.id)??"",d]}));if(!s&&e.length===1){const d=e[0],f=l.get(d[0].id);return f?r(ye,{booking:f}):r(mn,{park:n,party:d})}const u=e.filter(d=>!(l!=null&&l.has(d[0].id))),h=e.filter(d=>l==null?void 0:l.has(d[0].id));return r(G,{title:`DAS ${e.length===1?"Selection":"Parties"}`,theme:n.theme,children:s||(e.length>0?r(w,{children:[u.length>0&&r(w,{children:[r("h3",{children:"Select Next Experience"}),r("ul",{className:"mt-2",children:u.map(d=>r("li",{className:"flex items-center gap-x-3 pl-3 py-1",children:[r("span",{className:"flex-shrink-0 w-[48px] h-[48px] leading-[48px] rounded-full text-3xl font-bold text-center bg-gray-400 text-white","aria-hidden":"true",children:d[0].avatarImageUrl?r("img",{src:d[0].avatarImageUrl,alt:"",width:"48",height:"48",className:"rounded-full"}):d[0].name[0]}),r("span",{className:"flex-1 leading-tight",children:d[0].name}),r(L,{type:"small",onClick:()=>t(r(mn,{park:n,party:d})),children:"Select"})]},d[0].id))})]}),h.length>0&&r(w,{children:[r("h3",{children:"Current Selection"}),r("ul",{className:"mt-2",children:h.map(d=>{const f=l.get(d[0].id);return r("li",{className:"flex items-center gap-x-3 pl-3 py-1",children:[r("span",{className:"flex-shrink-0 w-[48px] h-[48px] leading-[48px] rounded-full text-3xl font-bold text-center bg-gray-400 text-white","aria-hidden":"true",children:d[0].avatarImageUrl?r("img",{src:d[0].avatarImageUrl,alt:"",width:"48",height:"48",className:"rounded-full"}):d[0].name[0]}),r("div",{className:"flex-1",children:[r("div",{children:d[0].name}),f&&r("div",{className:"text-gray-500 text-xs font-semibold uppercase",children:[f.name," @"," ",r(ne,{time:f.start.time})]})]}),r(L,{type:"small",onClick:()=>{f&&t(r(ye,{booking:f}))},children:"Details"})]},d[0].id)})})]})]}):r("div",{}))})}function po({contentRef:e}){const{goTo:t}=B(),{experiences:n,refreshExperiences:i,loaderElem:o}=Oe(),s=Jn();return r(xt,{title:"Times Guide",buttons:r(w,{children:[s.length>0&&r(L,{title:"Disability Access Service",onClick:()=>t(r(ho,{parties:s})),children:"DAS"}),r(xr,{}),r(Be,{name:"Times",onClick:i})]}),contentRef:e,children:[r(mo,{experiences:n}),o]})}const mo=mt(function({experiences:t}){const{goTo:n}=B(),i=s=>n(r(fo,{exp:s})),o=new Map;return t.filter(s=>s.standby.available||s.individual||s.standby.unavailableReason==="TEMPORARILY_DOWN").sort((s,a)=>s.land.sort-a.land.sort||s.name.localeCompare(a.name)).forEach(s=>{var a,c;o.has(s.land)||o.set(s.land,{ATTRACTION:[],ENTERTAINMENT:[],CHARACTER:[],HOLIDAY:[]}),(c=(a=o.get(s.land))==null?void 0:a[s.type])==null||c.push(s)}),r(w,{children:[[...o].map(([s,a])=>r("div",{children:[r("h2",{className:`pr-1 ${s.theme.text} text-sm font-semibold text-right uppercase`,children:s.name}),r("div",{className:"rounded overflow-hidden",children:[r(Ie,{title:"Attractions",land:s,experiences:a.ATTRACTION,onInfoClick:i}),r(Ie,{title:"Entertainment",land:s,experiences:a.ENTERTAINMENT,onInfoClick:i}),r(Ie,{title:"Holiday Entertainment",land:s,experiences:a.HOLIDAY,onInfoClick:i}),r(Ie,{title:"Characters",land:s,experiences:a.CHARACTER,onInfoClick:i})]})]},s.name)),t.length>0&&r(vr,{children:[r(le,{sym:"*",def:"No posted wait/show time"}),r(le,{sym:"\u274C",def:"Temporarily down"}),r(le,{sym:"VQ",def:"Virtual queue"})]})]})});function Ie({title:e,land:t,experiences:n,onInfoClick:i}){return n.length===0?null:r("div",{className:`${t.theme.bg}`,"data-testid":`${t.name}-${e}`,children:[r("h3",{className:"mt-0 py-1 text-white text-xs font-semibold text-center uppercase",children:e}),r("table",{className:"w-full leading-snug",children:r("tbody",{children:n.map(o=>{var s;return r("tr",{className:"group",children:[r("td",{className:`${o.standby.displayNextShowTime?"min-w-[5.625rem]":"min-w-[2.75rem]"} px-2 py-0.5 group-first:pt-1 group-last:pb-1 bg-white bg-opacity-80 font-bold text-center uppercase whitespace-nowrap`,children:o.standby.displayNextShowTime?(((s=o.displayAdditionalShowTimes)==null?void 0:s.length)??0)>0?r("button",{onClick:()=>i(o),className:"underline",children:o.standby.displayNextShowTime}):o.standby.displayNextShowTime:o.standby.available?o.standby.waitTime??"*":o.virtualQueue&&o.standby.unavailableReason==="NOT_STANDBY_ENABLED"?"VQ":"\u274C"}),r("td",{className:"w-full px-1 pl-2 py-0.5 group-first:pt-1 group-last:pb-1 bg-white bg-opacity-90",children:r("div",{className:"flex items-center gap-x-2",children:[r("div",{className:`flex-1 ${o.type==="ATTRACTION"&&!o.virtualQueue&&(o.priority??4)<4?`font-bold ${t.theme.text}`:""}`,children:o.name}),(o==null?void 0:o.individual)&&r("div",{className:`${t.theme.text} text-xs leading-tight font-semibold text-center uppercase`,children:[r("div",{children:[r("abbr",{title:"Individual Lightning Lane",children:"ILL"}),"\u200A: "+o.individual.displayPrice]}),o.individual.nextAvailableTime&&r("div",{children:q(o.individual.nextAvailableTime)})]})]})})]},o.id)})})})]})}const fo=({exp:e})=>{var t;return r(G,{title:"Experience Info",children:[r("h2",{children:e.name}),r("div",{children:e.park.name}),r("h3",{children:["Upcoming ",e.type==="CHARACTER"?"Appearances":"Shows"]}),r("ul",{className:"list-disc mt-2 pl-6",children:[!!e.standby.displayNextShowTime&&r("li",{children:e.standby.displayNextShowTime}),(t=e.displayAdditionalShowTimes)==null?void 0:t.map(n=>r("li",{children:n},n))]})]})},fn=6e4,Ir=["bg1","genie","merlock","tab"],_o=()=>O.get(Ir)??"Genie+",go=[{name:"Genie+",icon:r(rt,{}),component:Xs},{name:"Times",icon:r(cs,{}),component:po},{name:"Plans",icon:r(or,{}),component:_r}],yo=r(co,{}),de=ss({tabs:go,footer:yo},({tab:e})=>{const{current:t}=Wn(),n=ae(),{park:i}=Me(),o=as(),{refreshExperiences:s}=o,{refreshPlans:a}=ue(),c=te(null);return A(()=>{O.set(Ir,e.name)},[e]),A(()=>yt(()=>{t.type===de&&(s(fn),a(fn))}),[t,s,a]),A(()=>{var l;n.current&&((l=c.current)==null||l.scroll(0,0))},[n]),r(Kn,{value:i.theme,children:r(os,{value:o,children:r(e.component,{contentRef:c})})})});function vo(){return r(ji,{value:Wi(),children:r(es,{value:ts(),children:r(ns,{value:rs(),children:r(Vi,{value:Yi(),children:r(Vn,{children:r(de,{tabName:_o()})})})})})})}function Tt({queue:e,title:t,children:n}){var i;return r(G,{title:t,theme:(i=e.park)==null?void 0:i.theme,children:[r("h2",{children:e.name}),n]})}const bo=5e3;function xo({queue:e,guests:t,result:n}){const{boardingGroup:i,conflicts:o}=n,s=i!==null,a=t.filter(d=>!(d.id in o)),c=t.filter(d=>d.id in o),{goBack:l}=B(),[u,h]=E(!1);return A(()=>{s&&setTimeout(()=>h(!0),bo)},[s]),r(Tt,{queue:e,title:"Boarding Group",children:s?r(w,{children:[r("h3",{children:"Congratulations! \u{1F389}"}),r("p",{children:"You joined the virtual queue!"}),r("p",{className:"text-lg font-semibold",children:["Boarding Group: ",i]}),r(U,{guests:a}),Object.keys(o).length>0&&r(w,{children:[r("p",{className:"font-semibold",children:"These guests could not join:"}),r(U,{guests:c,conflicts:o})]}),r("p",{children:"Refer to the My Disney Experience app for return time and other information."}),u&&r(F,{onClick:()=>l({screen:Tr}),children:"Done"})]}):r(w,{children:[r("h3",{children:"Sorry!"}),r("p",{children:"A boarding group could not be obtained. Go back and try again."}),r(U,{guests:c,conflicts:o})]})})}function wo({queue:e,guests:t}){const{goTo:n}=B(),i=$(),{vq:o}=i,{loadData:s,loaderElem:a}=J();async function c(){await s(async l=>{const u=await o.getQueue(e);if(!u.isAcceptingJoins)return l(u.isAcceptingPartyCreation?"Queue not open yet":"No boarding groups available");const h=await o.joinQueue(e,t);n(r(xo,{queue:e,guests:t,result:h}),{replace:!0}),h.boardingGroup!==null&&wt(i,"V")},{minLoadTime:999})}return r(Tt,{queue:e,title:"Virtual Queue",children:[!e.isAcceptingJoins&&r(yr,{time:e.nextScheduledOpenTime,label:"Next queue opening"}),!e.isAcceptingJoins&&e.nextScheduledOpenTime!==null&&r("p",{children:["Tap the ",r("b",{children:"Join Virtual Queue"})," button when the clock reads"," ",r("time",{className:"font-semibold",children:e.nextScheduledOpenTime}),". The queue can fill up almost instantly, so be quick!"]}),r("h3",{children:"Your Party"}),r(U,{guests:t}),r(F,{onClick:c,children:"Join Virtual Queue"}),a]})}function ko({queue:e}){const{goTo:t}=B(),{vq:n}=$(),{loadData:i,loaderElem:o,flash:s}=J(),[a,c]=E([]),[l,u]=E(new Set);A(()=>{i(async()=>{const d=await n.getLinkedGuests(e);c(d),u(new Set(d.filter(f=>f.preselected)))})},[e,n,i]);function h(d){const f=new Set(l);f[f.has(d)?"delete":"add"](d);const{maxPartySize:p}=e;p>0&&f.size>p?s(`Maximum party size: ${p}`):(u(f),s(""))}return r(Tt,{queue:e,title:"Choose Your Party",children:[e.howToEnterMessage.split(`

`).map((d,f)=>r("p",{children:d},f)),r("h3",{children:"Choose Your Party"}),a.length>0?r(U,{guests:a,selectable:{isSelected:d=>l.has(d),onToggle:h}}):r("p",{children:"No guests available"}),r(F,{disabled:l.size===0,onClick:()=>t(r(wo,{queue:e,guests:[...l]})),children:"Confirm Party"}),o]})}const _n=e=>e.categoryContentId==="attraction",Te=e=>e.isAcceptingPartyCreation||e.isAcceptingJoins;function Tr(){const{vq:e}=$(),{goTo:t}=B(),n=z(),{loadData:i,loaderElem:o}=J(),[s,a]=E(),c=W(()=>{i(async()=>{a((await e.getQueues()).sort((l,u)=>+Te(u)-+Te(l)||+_n(u)-+_n(l)))})},[e,i]);return A(()=>(c(),yt(c)),[c]),r(G,{title:"Virtual Queues",buttons:r(L,{title:"Refresh Queues",onClick:c,children:r(vt,{})}),footer:r("div",{className:"p-2 text-right",children:r(L,{className:`bg-opacity-90 bg-white ${n.text}`,onClick:()=>V.deleteData(),children:"Log Out"})}),children:[s?s.length>0?r("ul",{className:"mt-1",children:s.map(l=>r("li",{className:"py-3 first:border-0 border-t-4 border-gray-300",children:[r("h2",{className:"mt-0",children:l.name}),r("div",{className:"flex items-center mt-2",children:[r("div",{className:"flex-1",children:l.isAcceptingJoins?r("span",{children:"Available now"}):l.nextScheduledOpenTime?r(w,{children:["Next opening:"," ",r("time",{dateTime:l.nextScheduledOpenTime,className:"font-semibold",children:q(l.nextScheduledOpenTime)})]}):"No more openings today"}),r("div",{className:"pl-3",children:r(L,{disabled:!Te(l),onClick:()=>t(r(ko,{queue:l})),children:Te(l)?"Join Queue":"Closed"})})]})]},l.id))}):!o&&r("p",{className:"text-gray-500 font-semibold text-center uppercase",children:"No virtual queues found"}):null,o]})}function No(){return r(Vn,{children:r(Tr,{})})}const Eo=0;function Io(){document.body.addEventListener("click",()=>null)}function To(){const[e,t]=E(),[n,i]=E(r("div",{})),o=Oi(),s=Gi(Eo),[a,c]=E(()=>{try{V.getData()}catch(l){if(!(l instanceof $n))throw l;return!0}return!1});return A(()=>{Io()},[]),A(()=>{V.onUnauthorized=()=>c(!0),(async()=>{for(const[l,u]of[[zn,vo],[_t,No]])try{const h=await wi(l.originToResortId(origin));t(h),ii({WDW:"America/New_York",DLR:"America/Los_Angeles"}[h.id]),i(r(Si,{value:h,children:r(u,{})}));return}catch(h){if(!(h instanceof On))throw h}location.assign("https://joelface.github.io/bg1/start.html")})()},[]),A(()=>{function l(){if(!a)try{V.getData(),c(!1)}catch{c(!0)}}return l(),yt(l)},[a]),o||s||a&&e&&r(Fi,{resort:e,onLogin:l=>{V.setData(l),c(!1)}})||n}Sr();function Sr(){if(!document.body){setTimeout(Sr,100);return}document.close(),So(),Po(),Co().render(r(To,{}))}function So(){const e=document.createElement("meta");e.name="viewport",e.content="width=device-width, initial-scale=1, maximum-scale=1",document.head.appendChild(e)}function Po(){const e=document.createElement("link");e.rel="icon",e.href="data:,",document.head.appendChild(e)}function Co(){return ri(document.body.appendChild(document.createElement("div")))}
